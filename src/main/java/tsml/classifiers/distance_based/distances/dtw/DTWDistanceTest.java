package tsml.classifiers.distance_based.distances.dtw;

import java.util.*;
import java.util.concurrent.TimeUnit;

import experiments.data.DatasetLoading;
import org.junit.Assert;
import org.junit.Before;
import org.junit.Test;
import tsml.classifiers.distance_based.distances.DistanceMeasure;
import tsml.classifiers.distance_based.distances.MatrixBasedDistanceMeasure;
import tsml.classifiers.distance_based.utils.collections.params.ParamSet;
import tsml.classifiers.distance_based.utils.collections.params.ParamSpace;
import tsml.classifiers.distance_based.utils.collections.params.ParamSpaceBuilder;
import tsml.classifiers.distance_based.utils.collections.params.iteration.RandomSearch;
import tsml.data_containers.TimeSeriesInstance;
import tsml.data_containers.TimeSeriesInstances;
import tsml.data_containers.utilities.Converter;
import utilities.InstanceTools;
import weka.core.Instance;
import weka.core.Instances;

import static tsml.classifiers.distance_based.utils.collections.CollectionUtils.newArrayList;

/**
 * Purpose: test dtw
 * <p>
 * Contributors: goastler
 */
public class DTWDistanceTest {
    
    @Test
    public void testGunPoint() throws Exception {
//        testDistanceMeasureOnGunPoint(new DTWDistanceConfigs.DTWSpaceBuilder(), 1000);
        testDistanceMeasureOnGunPoint(new DTWDistanceConfigs.DTWSpaceBuilder(), newArrayList(15.432294708507696, 6.42188291409315, 72.52319679097828, 18.797395954048078, 3.5479449213939565, 30.733778435056447, 18.36570410876039, 1.4429634784431646, 143.59034948108368, 25.122636860748127, 0.9768008862214729, 0.68189053201344, 15.414851715842158, 0.43621329235197154, 20.711463775516517, 24.636061334769305, 27.765805498627575, 12.764502515164034, 122.21649871334269, 27.305761965288188, 22.756683399086707, 14.786175931812089, 0.20824481131373382, 0.5645459953232312, 4.68448742239048, 11.369675972750155, 6.373244217803255, 70.21158909499157, 1.1383954433331978, 4.1187625787154385, 33.75467008932584, 10.825541043909878, 92.8986693880537, 3.9276801295781527, 13.834993533792597, 38.92967357049023, 1.8183723665300904, 1.0453671850007056, 6.224894726927579, 15.656230664387873, 43.12764619072576, 24.747407893814167, 1.9647701740315116, 1.7022397781402738, 59.589984980449515, 25.115851905578793, 51.068306180683045, 25.726141361859654, 34.48409066759326, 34.42995200033458, 52.62634655997221, 9.640268963442084, 2.2219183796491926, 19.459005940927398, 46.04916993252734, 20.100151313564567, 5.874486071716101, 14.864245007784223, 56.30318423522962, 35.42417859602421, 2.0278557796236485, 1.5849022809039173, 9.92644539207017, 77.20749239018964, 11.452179425038414, 10.951612762425027, 46.25008995475837, 13.776486460390533, 68.26799150334008, 30.784642511883256, 40.06360541604475, 25.92162702665433, 17.866127520366707, 77.44288814210961, 14.602521170982056, 8.171501908619732, 16.702269946147236, 21.972943762825278, 13.093489012589108, 21.352037026448457, 1.1605696004584587, 1.572665842297988, 28.414094401848864, 54.41535550622262, 0.6276006897620904, 8.633111968303771, 42.13426410092033, 10.588193915868134, 2.695735114098288, 0.9286799681316109, 1.1757000096488401, 0.5045103890962751, 18.26884292477643, 26.873074802517404, 0.9392201033647887, 1.3900712089873715, 16.65585299600511, 18.607306578915257, 1.482982958819659, 26.0841601266348, 39.101144021737184, 0.9930472085797704, 41.41013282982807, 1.1860686512456737, 39.87697126921642, 15.650999756256885, 18.662702128257834, 24.850498118217285, 1.2719085503172411, 26.962674585438336, 1.14248898840589, 18.92917907904162, 92.858740331865, 9.697174274650774, 4.236004271840921, 1.2451291203770787, 0.3565718741819345, 19.50379500096048, 3.324289539326197, 7.189894033644522, 14.644616453863627, 0.8638282534956766, 5.743295132065221, 3.831283296992595, 24.662136220954146, 47.889920170802924, 0.8755165959233843, 0.3792453762936045, 2.3436917558646346, 68.81862879900386, 0.11205384933330229, 31.53447256978945, 70.77451495595727, 7.354493522770677, 15.38347624876489, 19.235224935348384, 27.14621983948375, 0.8352499714784313, 21.939801969711983, 14.432130405043534, 20.97956818198185, 24.002185125043464, 2.028059010074793, 21.481555569140646, 8.002086970897144, 68.4897307405278, 3.3244275428043397, 17.187589717267063, 0.5469416926938909, 5.562794815631845, 13.229221770777803, 1.1963907384111547, 0.3071088142629887, 29.03959166867841, 0.2132036292771822, 8.735090783302192, 16.012115843059096, 173.35717480187805, 2.9302959581203285, 0.17556107801273949, 15.606223028520185, 25.830530851489478, 0.7689396142258232, 0.22681196761370456, 34.07633332834461, 0.17276771493736814, 0.10626423470414244, 0.9600030805375371, 0.36412058907573663, 2.6014025203238367, 1.6303595720709219, 21.167924411803025, 2.48857305678056, 35.441518276739366, 16.21361729637795, 15.090802962996111, 2.079621171915786, 1.3976320131479807, 4.451830637514684, 20.92876237752677, 15.52921876447785, 0.09816539643625576, 1.3702696487398907, 0.4218903577594908, 1.2323952221653167, 22.955675377417705, 1.5913579429313152, 1.274787665358226, 27.42950479220467, 0.4872386955022106, 28.799716711972117, 1.0301199227708315, 18.800468512280336, 7.556384751961641, 2.2026004308549987, 1.708440394513146, 0.15246259725678135, 0.1971475963552984, 8.439009216883642, 15.581553621392569, 0.3860176702379103, 0.9405054322567259, 8.613283257730572, 4.4433401822681455, 18.29354731910762, 3.077686659072185, 13.213801275046801, 4.549280267680522, 0.7273780298838532, 26.761791475003456, 0.720761510397517, 2.1101060872169537, 11.96887897343197, 11.174838859256639, 85.33109938026313, 3.31653770262213, 46.40669093089547, 7.167288505253216, 38.262161206643896, 3.900466586225209, 48.10190887122933, 10.314202697199349, 18.82774685927649, 1.9885559911787287, 12.318656138009429, 30.277958674443365, 0.30527302348616037, 18.44545796296773, 86.68660227618409, 1.5913579429313152, 1.0869027628257946, 5.643579633407782, 6.079687166249451, 76.51991652224419, 61.15890883075255, 36.56129656019284, 21.347559422891305, 0.1995080383280848, 104.39422455671554, 1.5978362108357085, 21.18996144322827, 0.47544343861493643, 26.36881331068926, 17.16555562355877, 11.72045406150007, 46.264865280380235, 2.2670377404127255, 16.189221739044783, 6.294979770185387, 71.17711901703449, 0.3738121418350231, 2.753514896494817, 13.268227579803085, 2.0517594288220558, 1.1525805305538546, 80.49517181598205, 2.4315106316116997, 125.7623025564941, 25.375133671897693, 22.201480384297884, 15.785995539459702, 14.655572875517056, 40.833688764956875, 0.7306161257880691, 2.9882476126804316, 0.6886793574938088, 32.323867674005996, 4.304894660652076, 15.766659117587484, 22.175756115377308, 17.138032681956343, 7.61905935270114, 0.21797577357689715, 40.80287712999735, 1.8919134769329677, 25.692301230314026, 11.587294461423594, 34.15596763005205, 4.876397279611501, 77.02703798278034, 19.836364322246503, 18.595274958553876, 20.862516540250354, 33.85559495797508, 0.7185652585278659, 7.834545630867895, 23.1442922598697, 30.64638283451946, 0.15524783560505784, 10.98295113244347, 0.5373283826091791, 22.610167745409363, 80.30517028274286, 78.74743769960074, 4.565014944433993, 54.93205585826332, 12.452739425600287, 39.80470028831103, 13.895163238647857, 32.14239736339631, 40.930235493983425, 6.152483931847861, 15.941327978246637, 0.5622406638295807, 23.351558612637156, 18.53958193918019, 20.64980962760004, 1.3092430506310457, 6.052457673417876, 0.3426772637470071, 1.382556986854926, 2.0961983159262347, 0.5056412357134831, 25.102028222206087, 0.778029993588414, 7.27646079387157, 12.586228770540083, 20.862516540250354, 0.15757438812862182, 0.8858988404644718, 33.29428665678067, 9.667720464140121, 10.502947172832158, 0.6469155903415956, 1.4780078665936909, 23.588742734806175, 19.305429429462684, 37.601238937392885, 16.31217108371742, 5.131644828728262, 16.89222881703677, 19.164988928367436, 18.762522271477717, 63.265303217826386, 10.45922292766507, 14.396629477784549, 0.9884559609144051, 29.319276714899658, 5.851615809436896, 64.4853422873204, 0.6229353261948335, 19.346362100950763, 58.46539424029496, 0.12353538251218474, 34.85073487507731, 1.9295582215308282, 17.12724500946084, 8.162108306170527, 22.32328650088314, 46.297568564004465, 2.6058341349586107, 0.2533327548108736, 1.7073325185347046, 48.276488840576455, 35.75920193523093, 4.928735079877263, 5.8432667975899, 18.13849809545462, 109.46873587282411, 19.076959644151298, 0.4508024797024057, 19.249270861598788, 98.28220826116352, 5.389746904861152, 3.591367410331119, 4.575326945187735, 76.1009392359567, 2.3978083073992993, 1.6508170351901947, 10.683162488909462, 1.1354961667227677, 0.8994377518432037, 2.5498510164625356, 2.906122625258373, 1.2807749132805892, 0.5695958122378882, 31.521382507924443, 72.30704356304534, 5.160815272620012, 0.1992962861345676, 9.218889720076143, 24.16926791707337, 24.022410017538174, 44.51450142435023, 32.16403806068676, 4.76769331513568, 35.82625987318508, 56.279408395879024, 32.58889809734698, 36.80418040445931, 1.9918629336023423, 16.36878921269137, 47.175341036055, 25.77233512899474, 0.8723667179487252, 152.0199604040882, 97.71639231373001, 0.27170925741455393, 0.9030339756728325, 14.985239814688878, 117.18199206446639, 5.157355395898264, 29.67708060019643, 47.00173647222738, 0.16909855481989397, 11.874632534637, 0.3426772637470071, 30.90280937230862, 8.144685840644017, 31.27165526053633, 2.030072771938834, 42.41813229698674, 24.344321080964924, 4.962612908903334, 1.8729844181314572, 30.199808922341504, 2.0744306706700293, 2.3644955844761886, 0.9172183585972323, 1.6033272873051378, 0.45374824099797917, 31.130229515815813, 3.6252450179141293, 0.3392434635716569, 10.10584121672343, 1.5797551748747658, 13.096336838137633, 106.09026652254539, 30.92958339332948, 2.0961983159262347, 22.373801322218114, 35.524168461324415, 0.8844436336293156, 22.29801071687328, 27.466607763245538, 25.74376566145571, 1.985878732047393, 38.10573710104395, 19.51208256419181, 50.30162975089295, 20.671052373912133, 0.33400690634318514, 15.619002842746523, 3.9844180908587195, 61.30829771484275, 23.407141921119173, 18.58090091116728, 0.8948922598885835, 2.5419188865631526, 49.90300821058117, 48.843275635390185, 0.7302151967138202, 0.7535847797915523, 21.082289467459436, 117.98404845223911, 0.2143796294447516, 1.007608665052268, 6.589278220428555, 13.00574049148381, 2.937337685886884, 0.6441950560125689, 22.684120204199612, 22.916878254048836, 35.72529205764737, 17.33511712045851, 28.118892113882485, 0.4567733826292157, 1.1170175667344844, 23.342696516053095, 93.78404877797041, 8.723692825263283, 1.7022397781402738, 107.53166297261893, 3.049165853256781, 12.784795701751241, 0.65210113715153, 1.8409876474363402, 0.25535229351391037, 54.572246129692985, 0.8956401408377039, 1.1323959971986415, 14.16875708273255, 1.607019386595888, 2.6894676422875383, 50.608762783111956, 0.4475854194992814, 7.108551369298129, 1.8049260241867564, 0.9967740013924543, 39.63035165086522, 17.525721480168166, 1.2062633373185316, 0.901140781063643, 0.12273502340619238, 0.4416545031334642, 0.4193470609971134, 1.274452579239513, 21.64459696428358, 45.64224937004555, 1.5797551748747658, 2.5521463149117696, 73.74990425971384, 12.96741072758624, 0.6626141223416026, 1.4631071941823794, 65.97591733155079, 18.858518830727764, 0.86209810218799, 30.802740584100253, 31.138061227143734, 3.283995323466708, 14.467090714665565, 1.8352809916963444, 0.8339467117812469, 46.208513560269985, 0.37031013780750494, 3.910303402381345, 20.77861169605637, 33.96262503218118, 15.481334924506289, 0.9474807204766804, 2.4559283892061496, 79.42386408129224, 1.3949092260777438, 19.230226619186904, 8.668668147792218, 61.11820422618937, 4.566841282892923, 28.18426986864477, 60.452713840750505, 50.60644298490439, 3.7521743374855148, 2.298131729292139, 14.453843142881306, 2.094222536462055, 1.4277654720460629, 23.36504778451442, 2.663974608009609, 1.6753292953646959, 0.26534367245034324, 3.4758315742122656, 86.34236262082469, 3.826589821756214, 27.585863010820713, 6.912925882232432, 1.9890072812162676, 54.261297996346926, 6.27087989821955, 3.0455501190846186, 22.959455056197832, 5.9153631454235445, 0.19940994576888438, 0.6625840994574715, 32.79447738470678, 34.168688471383234, 16.79614877084336, 0.7368278822429973, 63.93033329524317, 66.59487810957854, 0.7942372258720574, 22.06049334189816, 0.4410358732867177, 22.42804644284862, 0.47988177048022873, 18.388471033207434, 2.897906895570431, 9.480604503136835, 27.487986703894443, 3.85984518267941, 0.8332914473960998, 0.3623750598420089, 11.807883025406353, 17.088294993786583, 1.7201289427343178, 13.886212878454236, 59.17901396063264, 0.31095777560229065, 48.39910574302955, 0.3686076808695389, 70.7449712698596, 103.01092069784572, 10.27205020686756, 102.92610903158213, 1.6413165707330712, 19.783743231818598, 2.844505390533307, 20.875884236062436, 51.890962203029474, 98.63574384420599, 41.828020579785665, 0.8612137695352238, 7.401150795231949, 0.9930883232017691, 10.167667631730476, 2.1730725639843307, 0.8672873470206933, 70.00208759343413, 6.583250424550822, 0.7524878500703093, 4.596807351283782, 5.604571362824251, 0.6319527078742654, 57.58099295239816, 26.640886932882484, 19.700324973251234, 0.8498228123877585, 2.9339670418296744, 100.59472249154774, 30.38459502390139, 1.068021903028201, 0.597741297032384, 21.086456760157674, 25.70032031710194, 0.40399177429962635, 18.147561507429447, 46.88447719892329, 20.36954343248979, 1.773281559742102, 39.917526503743886, 12.290158016348268, 32.65885610587151, 0.6017164853626463, 51.88810356688231, 16.060665531261037, 21.79103620713827, 27.1093320596801, 21.34810298996723, 2.299511062817541, 1.649182597405534, 27.727387114560063, 0.8389002119459217, 23.108842594664836, 1.812458897080429, 29.76128767095028, 22.38311881108032, 29.649223262811933, 52.41629228729154, 19.022322345959285, 28.122287597957794, 0.22120778449571218, 0.4723958998222088, 44.14657575862874, 41.99524787522854, 1.047734909272261, 48.697315018462994, 71.85069269836936, 15.971951106866376, 1.0477441720751959, 15.40558364178458, 75.86637399276856, 0.26137316164031155, 13.09847861258963, 0.30674457646928494, 25.118879663472608, 40.94133152203283, 3.5141437221333467, 18.32569006962367, 0.32312553522880016, 1.8368374749572611, 1.7981559267432914, 0.4053645083657083, 37.84882889103581, 47.09731338528808, 54.17215884249683, 0.4694678275313708, 0.1550744700485913, 1.786825139897011, 16.791466704651377, 3.9239154726233054, 45.61675961004927, 21.767622109261655, 0.23214823631280157, 28.46144305322476, 21.837511871772115, 16.475574502088094, 47.089961022639855, 21.783780373083005, 0.23700726113606166, 36.931807333293705, 0.6956712915352246, 36.827430030601015, 84.41034531358684, 9.01684982067541, 18.102699268486077, 1.4574454074830692, 144.10531834161418, 2.450674066379134, 14.921471330833493, 3.449138550995501, 0.4404986359112742, 11.384943862105949, 0.7044059966904421, 1.1775346931068422, 16.093166995570805, 36.23739505337688, 33.501475155692404, 29.07943988010733, 103.52592879228169, 6.370777868778231, 45.835493852995846, 25.163970512135837, 0.8500835634058315, 21.85749637577914, 16.494243612507976, 11.943088742266166, 28.18182914079653, 0.5521528852135431, 1.0751545648026941, 0.4193815273270405, 0.640696844135495, 4.939613569934468, 0.491571060294959, 17.31958219236824, 39.691650121145805, 13.819924204507664, 16.92395833438054, 1.006691555583764, 0.8512606083495567, 28.68559920287198, 6.002925033624653, 1.0707401592546837, 10.541819883907834, 23.279913486029432, 1.8447052281902219, 0.549048017076653, 15.766250534145845, 40.20884117955145, 23.94033220737777, 4.647780212365214, 0.22508682115840395, 21.82060126392626, 11.08147916370197, 0.8683566868300038, 25.968639055954572, 0.39572283250154616, 1.4439871624576461, 20.543893095927395, 36.4693527091513, 17.932328504374986, 5.047465475414168, 12.350829630679852, 1.613126141931349, 94.32561928100961, 1.4834443861832556, 0.6093250325834885, 1.7354778245017612, 0.7950531036718134, 13.648087102961588, 13.977867731851902, 8.002934168727105, 16.579722732511758, 0.45556959699866656, 8.505578117475952, 5.748885311572137, 10.690259715491536, 0.7754589503959248, 6.71905062747262, 16.797843824352242, 2.481584961901628, 14.113861314420191, 13.309896497025987, 7.203311066499698, 0.1971475963552984, 10.227789296263305, 33.19382083934265, 84.69063662408125, 23.803117906234736, 1.3914958248656748, 33.08086231712424, 32.3995101131564, 23.261500351401395, 0.16106962448077786, 2.7206208012144066, 12.418001158055054, 14.590213760371658, 56.07462060483499, 20.830668832142432, 19.46784354241274, 15.115805380782318, 1.4677582382718273, 2.448977336372141, 21.521124362445676, 71.72429433748171, 0.3969835483826673, 10.88397391284557, 1.068160581230866, 18.217890265631976, 16.165261251789516, 10.47541992617599, 0.8035990780020984, 25.49894453113578, 59.86366621030169, 28.74612057031539, 18.144639362177998, 31.071501314819454, 1.4641381431686233, 10.857224535869415, 6.044871775073482, 19.787218972598325, 14.988083967166656, 5.946264433295177, 24.99941638591537, 0.9168558488466997, 15.676867990780286, 0.6671432667742939, 63.47344081121998, 31.68975152500573, 108.22059116308081, 1.2122054462363814, 1.3663755434129283, 6.945158522751109, 0.796691506842732, 0.7508242156493088, 27.00742523994727, 31.714084926996716, 90.7632793597573, 1.070798244793391, 17.74169696219124, 106.09026652254539, 61.11031464690326, 29.3427734810923, 66.91178741398011, 1.813330323150091, 1.924089996043462, 2.2741331040585906, 22.486291116566107, 15.90630078612051, 0.39765736884638264, 17.772706695322185, 4.340159122555845, 18.5478754764907, 101.34173311280281, 74.5509141357878, 1.362534762595565, 10.914460696403427, 1.355263540741677, 0.9508379196181705, 5.561359426602382, 25.90270394045559, 26.921156872653487, 14.03310945015224, 6.365630928398895, 74.93734912352905, 42.06076975613176, 1.5155321087257705, 1.1600261995647096, 33.58675381942282, 87.71658433555706, 43.79010460438393, 63.03844441225114, 0.5072344615276339, 1.1590960181088326, 2.8279806977763164, 0.15792384238349108, 1.7691614127641881, 3.59655182128682, 9.927454688525533, 47.25164424739092, 17.873383256594057, 11.889883982292938, 10.495520021061521, 44.04011633364746, 16.90915833415299, 0.24175356901536646, 0.583305081644903, 0.9320418358024394, 0.22672397611662207, 30.811549687028513, 3.7295686445905902, 26.685559910044027, 75.7613018265145, 4.290603596484385, 10.657765113933257, 0.21685593560596803, 0.5615764172452795, 149.74573165887873, 0.5002484106426456, 0.7354086748409853, 1.361609214416847, 0.20175732632745652, 28.53530260857621, 5.893328300369165, 26.588732025353263, 23.845003716572943, 2.4809897612651444, 5.80052756622407, 5.885564634725821, 36.44512233048537, 1.7559657215008269, 0.8588185298676315, 3.7442005290400973, 37.09360654287637, 20.620998839718325, 23.297210001951683, 8.89287259316524, 15.556924308403593, 9.581498865877977, 50.31329190633549, 23.43414428960723, 71.7672258083349, 2.8661884897548626, 1.082149073811237, 43.79179315699665, 7.636036711708296, 32.19280204591037, 22.99570421435149, 16.17342021016611, 1.202518518467728, 12.797735329744224, 0.18242507382602363, 17.039407158951906, 0.8512606083495567, 61.45132046411885, 6.366316562717558, 0.7505530472729922, 11.550885404847332, 11.295158056208082, 13.271382523932294, 15.511255766200783, 18.825549381004038, 20.249907047958885, 32.62732216011587, 2.298255274680345, 23.00548806073717, 0.9211206897771979, 1.9216057528875568, 12.118418630969837, 0.409644322776463, 28.990222704167408, 0.6325447234050778, 1.0034852551762634, 0.7588437098255489, 25.653303401189827, 11.191347981385363, 15.899691753177374, 1.0713592578164717, 29.357153730806242, 0.4568046769353802, 19.80416842816592, 27.35238718724435, 0.2132036292771822, 20.46240971634174, 27.031957297351102, 15.993082462302377, 19.533743055847808, 43.551358837191096, 31.868907526409053, 22.06117275087296, 51.92925201004691, 29.008365781402148, 1.8860613085588807, 158.10715374040214, 27.520232213392518, 97.57195749309876, 0.20609444215538839, 28.09415772608815, 34.42038826593902, 0.5764167245485663, 9.63950503032869, 5.80393838347929, 14.060088122918867, 21.500557391287323, 5.013767938194945, 17.577738490125547, 60.82357801985115, 1.5763751607109777, 1.2825685200678578, 12.856095366472527, 7.988309778305606, 14.968932752869238, 16.62877183048083, 15.017846801766854, 0.3673575144680821, 1.432695013565155, 10.812947092544864, 16.1842832113093, 11.798795997755247, 0.653692209995196, 24.70521155841293, 36.160275122952505, 4.01529809903826, 0.8230230420108678, 21.72303071919052, 68.0154153835402, 41.5814969069267, 42.830192345286434, 1.4304878377524004, 46.517944871013846, 33.28564962899601, 30.8661409505469, 24.481653801977988, 30.970090081928443, 52.951751901572855, 0.19620069530101297, 14.859565349733845, 0.6630469883994785, 18.007413543714865, 88.08488272482997, 15.414851715842158, 10.81515959856142));
    }

    @Test
    public void testBeef() throws Exception {
//        testDistanceMeasureOnBeef(new DTWDistanceConfigs.DTWSpaceBuilder(), 1000);
        testDistanceMeasureOnBeef(new DTWDistanceConfigs.DTWSpaceBuilder(), newArrayList(77.15541114035882, 29.741029491813308, 33.43302727973862, 21.981082929270837, 2.085597420438641, 125.99697398103244, 79.88473330450202, 2.8116119150347294, 1042.6083708302324, 21.184394568707198, 44.32384206089723, 192.02465918087267, 39.95288626733642, 31.558899155349938, 15.732963825071762, 1.1975396957579176, 34.336860591239486, 14.16492295832794, 0.8194254282496565, 2.174214738654901, 55.247073942398515, 475.6314922161295, 38.147816228297124, 1.4906297068390295, 19.492133920431797, 25.153365406438837, 276.2928718297092, 5.812367374164495, 3.0317026135212695, 37.31641769989019, 12.724700858004802, 52.971896389687686, 0.7790654506079407, 19.20131599342989, 54.76133732452028, 5.947227888800472, 46.298183985140504, 365.9143729055772, 420.50846431721055, 3.213567077688493, 1.1610918941859327, 82.46930527380448, 2.5630838329029326, 19.191006645719437, 46.298183985140504, 524.8148672708367, 8.56820577934721, 19.375091864514907, 31.671706728079336, 2.6429478816851257, 2.4736105907762784, 16.714330533973527, 26.385583194711902, 31.389715741228873, 2.249984320826422, 45.59975762744753, 3.0536511648897076, 73.74983653771766, 409.9326790223853, 54.86169003253178, 102.39188105917098, 345.2590951336217, 41.14181962136926, 0.4969801532393432, 490.5781444213777, 1.2400351559077298, 2.084528818741174, 19.42330699785712, 2.085597420438641, 1.186903403551766, 158.3215523053335, 466.6036618567688, 81.22737676856359, 373.3947122894182, 778.5501672797672, 140.20677313481275, 10.285481223335069, 260.4537290505418, 79.89240984604743, 170.78832854080198, 549.4280677267155, 48.140064601122326, 506.52534115691884, 65.96457855576006, 3.1106620912339644, 14.16492295832794, 150.12820117309212, 0.16882825857229392, 1.0132866104850053, 17.34159017439666, 390.7548460461711, 46.362217477070566, 128.22831256615888, 9.361870705467085, 1.129671646036261, 48.27499169882778, 3.7870453253804555, 3.142798229681856, 7.822651939000477, 7.707822289456569, 1.5049538848824586, 297.38936534716845, 18.327708967577315, 41.12487314676716, 63.5273960212249, 31.57440185503323, 0.6895989853717766, 2.331178099211574, 456.62091931614447, 22.97491754713419, 557.1081863275526, 38.07263571997728, 1.597460568843458, 56.9305373965449, 46.5445598539587, 222.60627750308242, 3.3710128983736287, 8.539808921214773, 213.65223515189066, 28.43152202234198, 1.3231159073456906, 89.87776429271891, 33.36008414718759, 19.375091864514907, 67.84441672738106, 24.081171532830897, 17.876130306989168, 15.506732324243606, 17.47044796498959, 17.3829556012891, 0.698938282000233, 48.054659210713936, 21.022210255777313, 0.7097493737307229, 58.45421424654385, 12.560651759289819, 21.529614239628586, 26.151745623633012, 0.34741541608387017, 4.186592905406945, 37.405066752609166, 186.55865519116279, 60.11127914597698, 13.695322636665633, 590.193974413189, 2.485224853255899, 2.077573960210158, 43.62297351424797, 10.51393420304412, 24.694558740289242, 2.2869313318762905, 370.05671266819115, 7.938327233016858, 10.995671373024267, 1.281405576626641, 2.3235002875728155, 150.85974406025636, 39.996983485198925, 2.9758649288910406, 84.90671345287028, 11.004996071998418, 81.26579602018354, 12.697189568563251, 150.12820117309212, 385.2583584360743, 11.12895499428314, 377.29678846630645, 68.53072851454024, 115.41854697900972, 3.920596790844836, 89.51736015514899, 58.55589056616134, 593.7215539847541, 13.708059849726888, 10.97076903245809, 36.92843910959275, 222.1449870737555, 22.658023879242958, 425.13065145399014, 497.9716873672309, 17.075768426750145, 103.88196622357202, 2.8116119150347294, 30.545277203018912, 5.853662252161862, 129.8865293387732, 3.0693757970907525, 9.709940287442913, 3.8023090404395825, 0.7790654506079407, 71.2518295568598, 62.19874014321683, 22.53199677446432, 26.340136747517665, 30.410650041543317, 4.680528427878145, 1.1364934659286983, 229.70568376730893, 19.919205170599593, 17.743079087833245, 232.7758385279817, 0.4890514275837756, 24.081171532830897, 26.19699340417417, 8.805294529182552, 374.9334946720918, 677.0895124654364, 41.32897426727152, 64.27294787850525, 51.20089977075905, 54.16714225501286, 61.82398303049313, 5.919838156042425, 1.1165647321136665, 169.201830825435, 21.317643971281313, 143.55141792038611, 2.7006597378200317, 1.832433825445497, 231.6482973716497, 26.101193666511524, 27.173876614055004, 1.3171997588471052, 384.91777343855534, 4.145244236702035, 3.4482427157297786, 77.63233978379002, 57.21951032360038, 474.4958239544267, 27.526466758239255, 249.9790597395972, 21.203181267703958, 22.54766821902625, 117.68137768904684, 21.317643971281313, 71.53790616505053, 6.326775348876292, 16.867487095324027, 564.919337084772, 98.25580458499718, 73.95226213693783, 64.31922171721291, 55.74163642230714, 150.12820117309212, 2.055757045805294, 62.54530972490799, 3.9675055299316497, 57.99460528887437, 0.8395118937753537, 570.7961015788967, 15.81862245475539, 11.779322149338473, 949.0602843707436, 51.21759502691678, 72.45379516318096, 1.5462677304692212, 6.314694565858131, 0.7790654506079407, 370.3277421472854, 2.770227717295726, 2.4262784555059875, 605.624187414085, 409.31233150957695, 17.372022095797256, 70.51771463289813, 366.10682968746585, 358.79152663533563, 3.234115932816237, 24.922392159012542, 2.174214738654901, 23.548338318928458, 31.605883396807464, 15.407273130174955, 480.45431789963175, 8.307772242409795, 19.498890955817956, 11.963042244306001, 25.486028296356587, 13.598245790806521, 407.0312203736397, 4.825616482572781, 157.57364978945162, 35.09127714933468, 140.20677313481275, 53.62400198508792, 8.727356439910885, 572.6731731597629, 32.53111053662112, 0.6367378835413574, 88.93254556202811, 12.058118519762875, 37.31641769989019, 77.50374284521818, 21.83291495948943, 1.5814930943290404, 26.441184749683668, 24.556239745987767, 55.029805147713105, 407.2052153349137, 65.47931073419778, 20.104284457842645, 218.83621411214705, 25.770971372414017, 0.5498356177170772, 26.63425953276304, 45.59975762744753, 6.374226924879915, 0.8595604172560452, 19.688173921921756, 13.745974055021788, 1.8766453364479545, 37.787875735029566, 45.09034097546172, 604.8807413147849, 13.520077631924972, 4.825616482572781, 9.894780081319311, 30.187309485799492, 77.68176839816331, 6.29945065370996, 173.74300049250513, 26.70059616007726, 14.94023025959433, 140.73300317661014, 417.16030435060964, 10.148249223042907, 1.2230057887083703, 199.35583528054838, 2.6099012618330204, 52.10274664581726, 1.0956842305450252, 6.674899714635013, 24.759398005012798, 223.8346864623692, 587.9086755652077, 471.57292640919195, 41.69956312671968, 1.6098644055243234, 509.43509081434223, 3.9675055299316497, 73.7967182900696, 467.0916265892676, 1.5758285220563373, 30.614974224062273, 1.8822461680704918, 0.1385711552079011, 14.16492295832794, 554.1415598695976, 13.439810345962353, 12.724700858004802, 47.30602592622855, 57.09844912552653, 551.6762116763823, 381.67993395704866, 464.5221617436205, 406.1128662149361, 12.718847701977307, 354.2267100672712, 2.0191187417319796, 370.05671266819115, 465.4721001969998, 52.54774474171252, 209.76347937079, 9.894780081319311, 19.835119141049802, 2.9321236548567757, 1.696307568747115, 473.54616750703684, 26.735960475981035, 32.86563098801088, 1.9892364550478558, 11.092370180846892, 135.47766531078582, 6.795384925734744, 140.92618648611102, 63.636347678741465, 54.16714225501286, 44.725395921795624, 0.6951893955346808, 9.225207290341897, 20.37544369914555, 10.363737262266666, 44.03715857745695, 14.16492295832794, 1247.431054267656, 84.44804793186043, 37.98309260208802, 20.17096029134868, 356.7219545365604, 81.12535333506624, 472.1703602642295, 83.14902362138304, 171.32471025833803, 30.46258604719309, 33.12971536429895, 29.76083462567573, 0.7999474613510003, 385.33868316354113, 1151.4463153750783, 2.014773689863193, 590.193974413189, 9.03510119847367, 47.100903142268265, 17.247078130381478, 2.9758649288910406, 0.33078212013522745, 229.70568376730893, 42.64134448038674, 1.6552129385648802, 4.279656160788056, 13.992448388956996, 207.6812112871021, 5.878114792170929, 10.52529960312643, 80.8841548884814, 223.8346864623692, 96.3113437909394, 359.3634276729994, 1.6896475934945885, 44.971922605932185, 0.3585406512710834, 77.22322825621697, 0.2209745480702535, 4.044350054533078, 102.54620950244212, 1.9672684741118973, 2.4245474484238585, 46.82217261635192, 35.80800701060158, 19.252097916989094, 16.73044025587569, 17.62869991970877, 65.15584353329427, 27.335966661606903, 726.9406482429115, 0.6387171158559916, 618.0243147300926, 22.460644859357302, 3.0693757970907525, 3.7218387367002084, 11.874599062300408, 26.098834060197735, 379.41270698674015, 596.9914603957316, 118.83533193772328, 592.6749977114137, 25.915738063792762, 2.249984320826422, 66.00948770788804, 33.781686438760445, 43.48333924618844, 119.71592385032407, 37.31641769989019, 549.4280677267155, 450.43422840868016, 95.96105341884501, 13.117481810776782, 68.19294188832228, 12.701595230004685, 16.44620991381743, 5.722404832713702, 26.178967935347973, 52.734516343149586, 55.03129694764033, 9.550198965987517, 11.877746920787779, 107.37424818312465, 10.849243754753555, 37.03418170592062, 2.5630838329029326, 27.515557093470903, 1.1483768684115614, 173.62348375742752, 2.9549544636331397, 128.52520869837699, 4.003233207936297, 60.11653346352595, 18.82936078573279, 228.34219133811405, 1.5841948894545677, 13.873927403678179, 93.21142619979983, 124.59631604611917, 11.897744375280753, 15.506732324243606, 35.59483158547449, 759.8204287691818, 5.768626459205532, 24.34853676325177, 545.2060533644211, 8.801612679955415, 100.88564517876756, 29.35846018852608, 5.894095286382813, 8.602835188799101, 2.4472030169503065, 27.515557093470903, 3.401516262726394, 2.0191187417319796, 16.867487095324027, 10.561787127175318, 79.80569030646696, 3.2170541034764883, 51.95734852402127, 39.95288626733642, 482.28161733076087, 24.759398005012798, 29.45722333798, 27.026964594215936, 6.115022580799036, 15.101882255766988, 9.107739601181814, 0.34741541608387017, 1.8766453364479545, 528.3875374725475, 408.6220704134622, 28.567111705334714, 11.419532658858811, 0.5043519387176515, 186.55865519116279, 3.114855509307951, 29.294306344641033, 1.6098644055243234, 1.5044178551352425, 467.0916265892676, 64.31922171721291, 0.9715907986001528, 66.27259919418309, 125.99697398103244, 217.94510171952356, 440.83810932007873, 0.6242465144323652, 0.3919530663590778, 438.63372280708353, 13.873927403678179, 27.567584635516287, 373.1973069434484, 1077.7059665329857, 564.919337084772, 50.28785770201314, 3.4220283052876224, 46.5445598539587, 10.363737262266666, 10.338435818351451, 0.6387171158559916, 19.835119141049802, 457.5432663731768, 1.5312133251103563, 45.59975762744753, 354.20851040223204, 6.501103977223126, 1.931451711021653, 56.972241363409346, 3.9641241300908874, 3.2555880178519967, 29.741029491813308, 10.799188498163522, 249.9790597395972, 295.2660827220063, 45.152305152048584, 10.799188498163522, 39.462056119829136, 236.7630381626368, 50.5240182584408, 3.3346106580827377, 489.35871221583045, 26.70124723653932, 1177.437300374203, 84.90671345287028, 8.13895857444463, 276.7424433896857, 13.111231081500698, 573.9617224230489, 22.658023879242958, 0.3422889963454785, 10.438350398649593, 50.138332971513776, 26.63425953276304, 22.56615198672404, 454.97927906462024, 161.39048030622337, 1.7136934247138969, 561.8060449626803, 14.0290505512511, 18.54028185621028, 30.545277203018912, 0.1385711552079011, 14.99296606038253, 18.563963984593794, 270.17940366747445, 4.941218943480334, 17.213879426477956, 3.943134651508725, 54.66693228442419, 0.5746234876924188, 38.93630764774789, 13.621450954584061, 50.969626184512705, 24.132968773258202, 18.3493075753116, 586.692309744607, 30.716503518275704, 45.95124320565462, 38.688282283452935, 115.31997800711912, 229.32297088317713, 7.157752842058381, 27.816412936925, 16.513358236576405, 1.095834092408452, 219.87965223677543, 64.50362010111033, 1095.2450767948965, 55.74893665933703, 1.120082772528856, 8.663775551247067, 44.232630221252464, 43.02621243654593, 56.3979166369191, 19.086855606715204, 356.87111025166666, 266.62306465024903, 63.98219571715791, 3.427317187461014, 100.66428336376423, 9.530120645789289, 1.6552129385648802, 51.95734852402127, 90.42632555133177, 68.1947539807783, 7.938327233016858, 370.3476239337373, 8.727356439910885, 1.6552129385648802, 161.58916141156092, 10.238432633983733, 370.3476239337373, 0.8174029566560348, 2.485224853255899, 36.27006067978456, 19.42168434194197, 1.7413681364835352, 25.88646869718774, 427.81233696454734, 493.6784270535817, 46.5445598539587, 13.520077631924972, 63.08583213945468, 1.065494845141038, 680.9359048650368, 13.622001124637864, 52.36202446461413, 77.15541114035882, 25.466080833521982, 45.95124320565462, 1.2631053089392053, 125.99697398103244, 229.70568376730893, 6.893026595165925, 2.040211730196291, 9.929870014211193, 2.4217417716327687, 190.80922739471822, 171.32471025833803, 89.26869910221329, 8.539808921214773, 8.876460032925712, 38.33673435261095, 47.33486687924918, 99.1656877150897, 24.556239745987767, 65.5711658631759, 3.5987934376269135, 72.45379516318096, 13.989265064528901, 12.429819860451177, 86.61156400177681, 3.050321669054095, 44.28423368057285, 8.681502134033762, 60.751151874477344, 1.4851995336041266, 435.39630321095706, 10.291489888934104, 27.567584635516287, 0.6820798568422834, 15.867426882575028, 45.39230400150721, 456.62091931614447, 4.103315581801279, 47.33486687924918, 197.4246174132204, 350.8353894174137, 0.5667643099086607, 60.247035557514415, 23.050442293631928, 9.550198965987517, 50.60079522963825, 401.0996012887764, 290.86566781580956, 9.80114001252805, 37.69178128413533, 280.50252537011875, 49.02048451479071, 19.293467342531184, 439.7500911201627, 53.479301013654506, 42.64134448038674, 27.173876614055004, 12.776250314411755, 2.751742985717607, 475.69807320309855, 6.3169337850441005, 1.186903403551766, 0.21496873507974926, 3.3346106580827377, 43.52719981601103, 20.186223518512715, 82.7440763876886, 3.2930877384244868, 2.4736105907762784, 451.67285124904157, 422.5325181764433, 65.78134036913835, 28.93999685277978, 463.18894320585196, 456.88169456175626, 56.42769894595896, 17.372022095797256, 109.70988079464553, 108.30403908846343, 57.21951032360038, 19.20131599342989, 40.0182149455146, 0.9250208353898196, 10.363737262266666, 19.492133920431797, 12.701595230004685, 26.267700094683004, 25.176544654700248, 1.129399955620922, 93.40810389327373, 188.92473490155726, 32.983584208691894, 37.3330099730884, 4.107306659154079, 0.5287580322835647, 1.326972178189019, 0.6569467799863142, 1.5584979781329857, 4.524334888962461, 76.80409628974601, 53.25434544251254, 3.8211334590651482, 0.570930531210246, 416.5130135545482, 21.203181267703958, 21.195222575612227, 201.95978034731468, 14.771228413904808, 497.32466681522027, 24.081171532830897, 228.77016341839675, 463.18894320585196, 52.24217341187643, 16.923407515273563, 30.884797194546433, 184.31063751434155, 67.35045715626754, 0.40647798642314636, 7.136510960087114, 34.837962186105926, 509.43509081434223, 1.3142640168540933, 13.989265064528901, 351.7691814590578, 9.107739601181814, 28.73886321460033, 1.5919752998143084, 24.34276647681593, 20.94926426154494, 620.8437557488336, 20.37544369914555, 492.117801717024, 14.313005054419266, 0.932227365034775, 230.80696855722107, 54.507091972804076, 62.19874014321683, 33.52067209346424, 33.76898479912427, 33.52067209346424, 0.8667049443845075, 0.8723042231531587, 8.409491416834976, 0.5320091015775478, 482.3138999011942, 72.18337711077534, 1.6552129385648802, 11.543072380078806, 410.77578640710806, 68.98304325627582, 1.5919752998143084, 14.78197512915654, 103.27612247154461, 16.69865512249197, 68.49460744376336, 7.938327233016858, 51.20089977075905, 37.03418170592062, 485.6796043662286, 14.289305095137406, 60.11127914597698, 9.48487290705737, 97.4470327645219, 70.35410768470891, 77.55013707364532, 4.044350054533078, 141.47443201001943, 0.5287580322835647, 12.724700858004802, 44.232630221252464, 5.184529462520767, 12.724700858004802, 473.54616750703684, 5.698703887089765, 23.66587620166777, 0.6820798568422834, 55.59399158878428, 604.1200271274784, 4.9468187651205415, 143.11903542948278, 58.92730108980057, 450.78329823848674, 32.22904954607526, 1.1364934659286983, 17.010336688192123, 1.216886621242948, 80.5730262389394, 1.6017504094346506, 46.28117747990884, 10.923761864627679, 81.44213649035952, 8.539808921214773, 2.473273135970027, 41.755475707032446, 417.16030435060964, 13.005190565924904, 33.52067209346424, 5.198511515465674, 357.56407881178876, 225.97833777885873, 23.174209307534714, 103.01948017171948, 2.366846173771808, 55.74163642230714, 3.427317187461014, 10.238432633983733, 32.725786107105996, 65.15584353329427, 30.410650041543317, 23.939128672521687, 481.0721072764021, 15.095859236531844, 17.010336688192123, 11.975999351361414, 466.9552512739294, 181.76713408778275, 27.339048850342778, 49.76496902439442, 10.6675210045096, 1.808238493079044, 5.817322390722845, 106.87361737498395, 73.74983653771766, 18.753665909365953, 23.48304145032263, 46.13971922642758, 22.788349809097284, 11.155111385559717, 4.524334888962461, 46.68508959085874, 94.394777445299, 2.1684622275513337, 108.24538586909495, 409.9326790223853, 19.835304471671982, 2.522058629634416, 385.2583584360743, 16.031805331143534, 5.878114792170929, 409.71280524467403, 1.4906297068390295, 257.9512816107612, 59.79722250163464, 475.26485812817407, 34.929118233524925, 4.054553350856177, 64.27294787850525, 2.8116119150347294, 646.988166133003, 16.234783462419042, 19.42330699785712, 39.4343814822777, 369.6649526328343, 3.3710128983736287, 121.28753681997041, 1.095834092408452, 2.9883364463112603, 4.884726384864496, 362.4671806714906, 517.2331066258255, 17.77080677658683, 3.1106620912339644, 1.4730588312663777, 3.2555880178519967, 1.7598740745195436, 12.617241590191943, 15.152389543980302, 238.48849314063554, 6.6804860300878754, 2.4485432506834623, 14.526831446309192, 5.733473356982361, 0.8354375287987779, 30.187309485799492, 106.3143795113389, 5.125046128221594, 160.05056622905656, 8.585065123421872, 158.3215523053335, 29.6008393751945, 115.94794000916572, 604.6755359492357, 40.0182149455146, 2.769954710564864, 158.8980660195338, 174.52054293752312, 17.77080677658683, 219.87965223677543, 4.810785066246777, 56.34412655779186, 43.885484971510124, 5.878114792170929, 47.421335583468775, 48.50595205368437, 36.4808695720522, 11.263501157572659, 43.02621243654593, 27.90509041291418, 180.43698166568518, 469.20379044963, 15.51139712025179, 54.66693228442419, 10.561787127175318, 25.38735906460907, 32.74751076245529, 353.66663637210445, 13.005190565924904, 44.173078721402966, 51.83060948743347, 45.59975762744753, 15.50148226484751, 22.976728441562337, 16.513358236576405, 0.6242465144323652, 5.758505226313032, 44.232630221252464, 33.125010655196625, 51.21759502691678, 14.004816678715663, 23.129516585959355, 415.2530411386258, 2.6712105223003006, 20.186223518512715, 38.03315657814664, 1.8355858329207835, 9.03510119847367, 32.86563098801088, 19.68597980215199, 1.0946617234471103, 33.76898479912427, 0.6367378835413574, 25.176544654700248, 6.326775348876292, 45.59975762744753, 205.97523410230562, 3.1106620912339644, 2.174214738654901, 4.22824331523765, 128.9964144696369, 104.85462433808198, 6.969436206016047, 856.7135932336911, 1.2629590558535504, 26.091716970020453, 26.151745623633012, 0.6115354276183046, 55.25660976536426, 1.5088645748917222));
    }

    @Test
    public void testItalyPowerDemand() throws Exception {
//        testDistanceMeasureOnItalyPowerDemand(new DTWDistanceConfigs.DTWSpaceBuilder(), 1000);
        testDistanceMeasureOnItalyPowerDemand(new DTWDistanceConfigs.DTWSpaceBuilder(), newArrayList(10.875830784759142, 0.40331347281922303, 0.7886975014031323, 3.8205005227684268, 0.23161376893799673, 0.4338278564737777, 26.042914338236777, 0.9842619955969578, 2.6946746317775943, 1.3671882417744916, 2.6830066845289613, 39.999536207821016, 2.6668053016170523, 1.4503886014767147, 10.4994749943199, 2.8650386502968193, 5.584522985044272, 2.603623740049958, 3.4660367234493843, 0.8161698783283677, 1.663171550279957, 1.0348787662850816, 3.394454954523225, 2.532388065028753, 0.5490131764518148, 0.44385960839639427, 0.8936729648744772, 5.747271504257721, 1.7003230875892623, 1.8240464152484224, 0.41839507156747846, 11.53098101748432, 1.8752202441256378, 8.542970702408127, 2.6863927522815403, 0.8695588527963933, 2.274921960625661, 0.7768003610565821, 6.005813576534459, 1.9561454856228955, 0.27297732166081123, 13.805543951828115, 0.5533036660377834, 1.5663291499102163, 27.652442904547865, 1.3487786710129241, 11.18402891009819, 17.29990634825287, 1.9003919871814896, 24.49562161633037, 0.9277433577823946, 1.0984364089022542, 3.0883411234269476, 1.785350990219147, 3.1788897534028284, 9.948816153759013, 2.517718132262558, 3.235754185010272, 0.8774880682611791, 22.108118320457255, 1.2243045656346432, 30.60954943501156, 4.609476752847335, 0.785063130579417, 1.6580756881853924, 2.4803015018771184, 6.2116334248279745, 9.715050904466636, 2.5877466687696553, 0.47006847926285894, 3.660516276275629, 3.472573977743111, 1.6008403374598588, 0.5345481634960669, 1.7872130442444938, 0.4917241561615506, 1.7449690219872283, 3.6747932006412998, 0.6260560389156522, 6.5718704927489835, 3.2119692162772786, 0.8147890051552085, 0.9618169669498255, 0.5917140452052193, 0.3723331448703063, 0.22801276403319318, 0.41535841288072517, 2.005065098463455, 2.307525717904356, 1.4511960738370089, 1.0740326767699633, 1.0827564412383528, 2.1958653375737995, 2.8430092016573267, 0.9345815039444806, 3.497854391807741, 0.8165548678946962, 4.366100162275472, 7.854138822780007, 6.535474511319642, 2.039575735184695, 0.7585477469925817, 4.554392594525241, 0.3541380969569137, 0.9910293121236081, 3.506150670116528, 4.245565502180147, 3.820013888170281, 1.109223471293406, 0.8632955822522594, 22.56984924915621, 1.7773419957642602, 27.49602341597128, 3.85967355302501, 22.160310767246248, 0.6407244522697975, 3.606721850730511, 3.444678971712348, 4.7429111184846455, 0.3160991254261195, 0.6838606174750007, 0.5843198066340338, 6.13261455780523, 4.101125309692279, 4.3035588783764505, 20.76704987057055, 7.528384094868686, 0.25725189175596447, 2.456290252443512, 2.0226526567852336, 0.8775988925391635, 1.8037410981845707, 18.938997414171574, 13.980326752135287, 3.1448466752615416, 10.89962562471513, 2.708490137105518, 6.015093031991038, 3.187356347855601, 5.149111284233951, 1.8229384238205275, 6.902688329428167, 1.5712057812845694, 4.969853850929165, 0.9186321892484298, 0.5305735756949997, 24.154212505671318, 0.3210523235344791, 3.9121188859718936, 6.18476334825706, 4.518365504768401, 15.738989193882054, 20.60712416866047, 1.6233397109341299, 15.447466886381896, 1.292198041179016, 1.4655421322046422, 0.5232870945144859, 18.582532981118675, 1.322362050244478, 1.5316094898423795, 0.5598099660759078, 2.6675555410970864, 3.818095238981188, 5.672878645002414, 0.8939457415804952, 3.8680904763104538, 8.939576829504023, 3.511607980617676, 0.7395667259402036, 0.4901586357589178, 0.43437898006121956, 5.119984972434526, 0.2591511947512031, 9.483595529129888, 4.159754666675153, 1.8809498972362488, 5.7749667923486045, 1.4403279947883805, 0.8085583296255605, 9.73501481974536, 5.444528375745782, 18.860790950145557, 0.5811412716084764, 2.316027713448301, 2.3100739712659353, 35.3863974727901, 6.837201184643321, 0.5179266655451058, 5.619495672966677, 0.37983369197204125, 4.832908222957995, 3.8066187642200826, 0.46070536212559277, 1.0394518236934551, 2.9290221199392494, 0.5992464246614361, 1.7662632284658975, 8.185511120534997, 0.4412130811902885, 0.7570171243518478, 1.0031270363455504, 0.8836839670431279, 16.212638876796348, 3.702584252050197, 0.7990950418042319, 1.345723667792282, 0.4415023447354611, 11.926296568846414, 14.521765246069021, 6.582299841659743, 1.965475846990289, 4.457400378610634, 5.542391039824924, 0.5142530630031881, 1.2322405320402428, 0.9458344396846509, 10.353749352413736, 1.1121212227049566, 0.5426656685514926, 0.9936568353829056, 18.02366870271354, 3.031829798505365, 2.219750174063739, 0.9161017393887363, 14.696892641667889, 4.332012131449025, 1.237228572147488, 2.8233874877881933, 2.0934199402516778, 12.73226992206936, 2.3164702476610723, 0.9369861157088574, 10.751129787161394, 1.0968837416059483, 1.4090387419712087, 27.845619932528084, 2.7055972751539583, 4.16881042631101, 10.070988561334081, 2.002518237561293, 20.86988545717716, 1.152792794584838, 2.3314973673456674, 1.3700259389881666, 6.223968132561567, 10.760146812794007, 4.302700041495845, 24.270961806838166, 35.05833147759391, 0.557416727905929, 1.1417840212281272, 1.3749197308167471, 8.339860895606844, 0.4961643054898765, 1.5715503622152656, 2.2236129322626974, 15.168586719899446, 2.845485103964685, 5.931080163309789, 1.2218799145012296, 19.086441156798692, 1.119727897740026, 0.30297179049251355, 0.31705719905046764, 15.582357833051082, 1.8944100209082575, 3.27787253206756, 2.746862784106231, 0.7431593866126025, 9.13800544107258, 0.17421965801530434, 9.812488923617002, 2.126658481937632, 1.8029063975205872, 1.2761157655107773, 5.115445465016603, 11.703297602311125, 6.504662801243979, 9.594475035941054, 4.859522099148359, 3.710094960685615, 2.5319090957876584, 1.4319433038437863, 1.5236627687407829, 10.496999981357952, 0.9098977037254784, 1.7829461849331991, 24.839587286769056, 1.4117196172665034, 1.2224449365792236, 1.2011101582172694, 0.2444410954362987, 11.3004513385403, 8.421234340444459, 1.6978518755997907, 0.28007514847958337, 1.2709922481091394, 1.0166267107014748, 16.082904189432494, 11.991911989043343, 0.9348108423914568, 3.473163030594971, 22.293798394653226, 0.650979464506229, 3.6699274658160803, 0.9508257500292432, 21.811302640193105, 8.198618190310263, 1.0919210662811638, 5.089949799458597, 1.1899889332648304, 2.5605886003204676, 0.8613695853919967, 4.573173256372878, 5.058151596356507, 8.869686714318885, 0.923188645580487, 4.903688633047161, 15.24732499504325, 1.000600711279438, 1.6156029206799476, 1.5485203049219034, 0.3645204113126045, 2.318964229141677, 2.407642627949589, 1.8980805452433156, 5.923523522615485, 7.151436857740849, 1.952815560978034, 3.006623832224457, 2.2998899353139515, 2.627694280803592, 21.979270007977327, 26.578903397467, 1.0693167058988482, 1.4716860432305803, 0.5754336976109996, 1.3021117547256496, 2.551747122789418, 1.577381858525652, 3.1385844407172923, 2.0947435435857504, 2.1918528154957144, 1.613859347943272, 1.0044774915467585, 0.38125081796210875, 1.4155384568332403, 3.8695154226107937, 0.7668383002292997, 8.205171012963877, 11.798246978709056, 8.96014359246607, 1.9375098397993007, 2.6299768121131684, 4.630836355921851, 9.996201997099062, 0.5871926910845787, 5.492718052066407, 15.036343662148926, 1.050536887608694, 8.137911000952334, 3.080876913045545, 1.0018586243285579, 6.472179111109156, 0.9436573560091592, 0.6501709469694276, 1.316267653596881, 1.5321152253792651, 0.4397139010448374, 10.649024247087775, 6.438793185530483, 20.81331109313938, 20.324994850018825, 1.9091854470198784, 6.263283384040775, 12.041110680082117, 1.7498199308868874, 3.5509022695297956, 12.632599631509157, 4.9448189664465225, 0.4417581769476708, 2.8894868575552572, 1.8167301655714183, 29.73594123570919, 0.5828349681422826, 0.7349813459994061, 2.1821706172525235, 15.793321407948355, 11.969572057607097, 0.976398052915561, 3.318054519406666, 0.9498240240430365, 0.9715514516037751, 14.555686391698822, 11.506692651974825, 0.5296034577182419, 1.2765554360354463, 0.48191018504188937, 13.445006744024731, 0.8424996089212, 9.707866533451694, 13.137646098627673, 3.896842133077185, 15.09495404831485, 1.843632884881931, 3.666924285668898, 0.8611449278303119, 4.268106750076868, 10.006034934697933, 1.7603038719387178, 0.9572159330836678, 4.078935455037977, 0.2770630728135224, 9.092608214928537, 1.7044299221028814, 10.760251931774341, 1.5995570232056358, 4.279658833543935, 0.6927145745637273, 0.5273765406971335, 19.100010755009635, 7.470952781229976, 8.227724617185162, 17.75637485065606, 2.2738375818434378, 1.187497006771867, 1.7679047332871676, 0.919312224919149, 0.7862371609473296, 1.3265937455261751, 1.6081802176381246, 2.0548459485379915, 0.5499326310192348, 0.5317296757847123, 1.6783877108235732, 10.25197911099875, 8.534001931705145, 1.4657856179951676, 2.2597249949125198, 1.4252761060608268, 1.361047226160117, 19.08977878458851, 4.761460488724429, 4.734220508065784, 2.4230146506068193, 0.7999836980078808, 9.523396801552908, 3.8644618649830234, 15.609944506053832, 1.5589486353451032, 24.686289446510482, 3.121214217877592, 9.161126835054674, 6.319808872666501, 20.288395511403614, 18.21452339523064, 3.1118891748352513, 0.9881982360583181, 2.834199191175868, 0.9847269308382046, 12.575803401914374, 2.2717554874585475, 0.27344062516559414, 3.103186962161381, 1.317920433904998, 2.358048141393928, 1.246253830738569, 7.036099727126047, 3.7766610564756853, 5.651155774199815, 9.147195697750776, 1.7414161252027596, 9.646268673442748, 0.736704846449991, 12.306512760698276, 1.5259389637677852, 3.2622692289802435, 7.306952215048404, 1.5997099042692458, 8.124338623043736, 8.03473997826205, 3.2652474741868924, 1.083668167182308, 9.037109801559817, 5.5676670822283905, 4.569150290061488, 1.1548778237298354, 2.135783688050717, 8.285644901451038, 8.003236228903944, 5.470639499997972, 0.4999673139012928, 7.745576162707275, 1.613389069307066, 10.124386952795643, 4.58573986423316, 1.1766844206513116, 2.1367293016052593, 3.7710576901455437, 2.538877151873421, 0.6707525886378063, 1.1338141426413746, 2.179569476330938, 5.717564306837759, 14.699868166239916, 1.3528505726146975, 2.0278632028231574, 5.393046993855603, 3.8930234144740457, 4.358772904065834, 6.329577091183577, 3.1428570502945257, 3.5549651889067304, 1.4432536937099516, 28.847137440073634, 2.1887051428564086, 18.72726628647207, 4.601602435513388, 1.242830179798914, 4.138129300846385, 5.148120647497928, 0.7682253363828432, 0.1993952499255211, 17.932625298276587, 14.205791990164183, 0.4851463198687406, 1.4130818933965246, 2.3463543909654687, 1.5778452306876065, 1.7401865349404873, 4.096511763843099, 1.956939593126707, 0.41468844309272207, 5.331920782278186, 1.186214800057032, 0.1965157083005942, 0.6583119701135322, 1.6167542496797247, 4.548674397989044, 0.970345480272218, 3.2878420633721293, 0.3786365859483866, 11.615381099633131, 1.5178481128985704, 1.2363631215032744, 7.752348058288722, 1.6327163123791064, 0.4274938104401944, 1.227708886033695, 4.608358330372755, 0.7754863542373052, 9.793788827413156, 3.627265437450823, 0.3831931689793581, 8.511936222347668, 4.597751556212988, 1.6568269905020123, 0.6800205389756206, 8.796716386814127, 0.7269697590387446, 16.735028622801913, 9.797917045703146, 1.6781177656899682, 1.6750257187826076, 0.9094017191147923, 1.1706621134321182, 4.2750239209615035, 1.6527583480128811, 36.8692263307427, 39.492850212794906, 21.92994679025871, 3.595060309614611, 3.6760863514703406, 2.2658267498299907, 3.8403819045145235, 0.786114651802762, 5.988633181866347, 10.951151154376014, 11.187932218289284, 13.249440910210701, 3.953453771726191, 2.3791482084231443, 7.753286690762999, 0.5469049203268721, 0.5156159238604792, 0.612042416054419, 11.757457916093092, 3.3608377573847754, 5.483181556696905, 1.9527723029527555, 18.734948479552905, 2.9012889271994946, 6.550017897162954, 0.9501035588474231, 6.762045265275183, 1.6813836796217831, 4.864870052735913, 1.4230820849413608, 0.6102283517491759, 0.5351231358927168, 3.197133465866816, 21.144964258121192, 1.531899076023082, 0.1707574104379421, 6.8608327998229, 11.088849107105778, 3.668465877998803, 0.9454848294660969, 0.447622036574338, 17.32606975589824, 2.951132676461605, 0.21000287665180972, 0.3080457533747487, 18.096624602307383, 4.68393648746298, 1.7033754565546808, 6.952465071238146, 0.3314661211993602, 1.301742123891426, 4.209926004657799, 3.3503561329595284, 1.5937944691652401, 0.8266253082187788, 5.248914248616862, 1.0249454805418454, 0.4163204745008072, 6.104943698400041, 23.284810314163046, 0.6978953517912809, 0.3335237578763862, 7.248318396236765, 5.319435952195682, 4.774117182880703, 6.596144595559816, 13.8780764057355, 1.0599814469261515, 14.554201515358143, 5.271250008530099, 3.6754276099036174, 1.1644117900190065, 1.7113861669993153, 3.1243523090177248, 34.20226299941585, 2.7188338183898777, 1.1102386732072984, 3.464587367448721, 1.3748409910741284, 4.284967714751369, 0.3984504006430943, 14.595800235002113, 0.5187223919242046, 11.734108829745878, 2.8801264730475076, 6.279718814482191, 2.689314728127429, 7.94615618897798, 11.379277672300686, 0.19898579902558122, 30.172866020636466, 8.22977893946808, 6.502466088799784, 4.32445509778104, 19.64798085505832, 0.96493822780752, 1.6341853720091504, 1.2248377248797722, 10.95837770281556, 5.268349160649065, 1.674168714942653, 0.3788932497017648, 11.99679249506101, 1.3624265107110538, 17.005288149566763, 6.6870641605151455, 0.6968103843803147, 2.4680072446839683, 1.861860720551796, 1.3878978026087334, 24.290250901488513, 3.074159023721404, 5.3359492538875335, 1.968867085260049, 1.29433412045723, 2.81806348420124, 1.0168695774959653, 5.333135141935435, 1.240704428000904, 10.525623687606952, 0.9522755355866875, 0.62006261572036, 0.6035398764662412, 2.6662356694406295, 12.617187144637164, 0.48203172899228175, 2.5479942617538125, 1.872181697725138, 16.755076073299584, 1.2551394440815558, 3.1442673905254153, 24.50702279976079, 1.5146606272135064, 0.9407336766579536, 26.369920605013128, 1.5006001801984765, 3.5974411817873877, 3.8867928052765017, 3.187679427040134, 2.199497379596421, 4.814174655547448, 0.7871314602599695, 0.48708026612378574, 2.60741287851638, 1.2685144721379475, 1.3343947304515253, 0.9384566005843044, 5.1841565636254545, 10.177176135684814, 1.1432156237804452, 1.1086115357376385, 2.433184054409687, 3.5339395266731164, 4.858547996337667, 0.49308541822675733, 27.083148807122136, 33.538332520345456, 1.4689349106971321, 1.0260472196309773, 1.6442005082264974, 1.1109681382304253, 0.3599425723074971, 5.975742685496421, 0.7575663509642866, 0.27607254681229954, 1.0530475788745297, 25.972691060679196, 0.679445565336541, 4.250180805351004, 3.3629268313059852, 5.135594251764423, 0.5932999668342792, 1.7479679094067315, 0.8432937639141259, 2.4866293953730603, 0.5486889503045834, 6.9076755885213394, 1.3258853368802503, 26.24679730589154, 2.348201191311551, 0.4004642099700099, 21.48572194976416, 7.087058278678104, 1.098140171529733, 2.3879754199498606, 5.666530334817555, 1.6415180656277242, 11.649950289379959, 1.1647143562742819, 5.490997070314517, 0.287676621685359, 2.4613146590526673, 11.127223785474389, 2.2817575914175148, 0.6163088411508592, 5.308937069996524, 9.250924512121, 1.3459802729214974, 2.983637226015856, 1.6753615441495997, 17.812246681139012, 0.36626064106697576, 0.6869995592145043, 12.753412521227006, 10.205419362526165, 5.513878309471778, 6.032328376260321, 9.778645417056818, 2.932004485784955, 0.9257999200734427, 4.993560822096419, 1.568087209423831, 3.8039576531285624, 1.4187400596767767, 0.8907175301215684, 1.6801757569938087, 1.2149427590757744, 1.8104289313955897, 0.36655393585154267, 5.622370745965607, 2.6376828876689595, 2.970957921931383, 0.5547606872039331, 17.415147024817756, 3.9123532671392396, 5.431745861680843, 25.874866174104294, 0.6438343052236767, 8.83531467402082, 4.636765835240276, 1.5549966767881152, 3.829425517435852, 11.258962430756133, 2.934246468111021, 1.209575316432287, 20.98910896573257, 0.5279372814302189, 0.8553914808109163, 1.631144063635762, 5.667201954155979, 6.07996513093165, 1.7268019296607655, 5.25072486167398, 6.1036961863990875, 1.836054840631941, 3.11992053582906, 2.6674536655700747, 3.2301968837270234, 1.495998054081189, 0.5982947161259765, 1.9996042927284086, 0.40901889317284157, 0.9818470798419265, 0.6358557375582429, 6.280286626308789, 0.9473318880554487, 10.30703631367648, 4.198005111683363, 1.4148783187168106, 1.04402030836808, 1.4394572687862204, 2.097944256398622, 1.2173719179630724, 7.408190372077331, 10.891667282610875, 3.659876931752341, 2.7000411484300346, 7.3928436528604, 0.8035869520777342, 2.40622293036169, 1.133713467548384, 2.798712672960008, 9.517793531395418, 1.806624881984889, 1.4821018254405802, 0.32560135007541147, 1.0428933925776196, 9.650832220306626, 0.7482246987087662, 7.5174561192950184, 3.077437145716743, 0.9523961507685031, 0.47666374267508393, 15.74820364938456, 4.5421213509047735, 3.8654294302133416, 1.1856728365253877, 10.021204150552915, 21.551099077468916, 0.4012067421937928, 8.49462921530659, 0.9536650192318195, 0.32788977661637, 6.835395416139557, 3.0962610033541473, 1.021850315276011, 4.825541307055895, 5.432492206402378, 0.34021733528743575, 0.9912140392788645, 45.69464139275186, 9.622209448292084, 3.345163511633984, 16.365790944755005, 0.516013471985026, 0.3228684700853731, 4.872109694657049, 3.780849932167508, 16.173439742806135, 7.663444221139165, 5.882773481160265, 0.3763604630155095, 0.3972604616069515, 1.20331918419117, 1.6395040951433346, 1.630366371179731, 1.285360830048778, 3.537371894306721, 5.207671325580614, 6.326962058263449, 0.2855671098844992, 19.135855882794388, 2.7150038927327476, 2.9455184337802174, 1.270450111103695, 1.5864488612085514, 2.1413469051511664, 2.34079988509065, 1.4216981413298604, 22.500389193002402, 0.6863355486897099, 0.5266411648114443, 1.975062783472782, 1.2934369900983589, 5.239875478178888, 16.2337766775248, 0.31921584670173986, 23.325363367962822, 1.9324412812078788, 1.0506030916641356, 4.567486454183863, 4.1292257990188945, 2.7732418041440465, 1.7036623669579813, 36.68257475595897, 0.4807619792751142, 3.69822832475634, 23.577918854910052, 1.7571485612933713, 4.435129332896677, 1.6503883307248, 1.1734350450743682, 17.6412381977686, 20.61289721414774, 18.031739914469537, 0.40332675661263473, 7.778922764121063, 0.5203829381143719, 6.712824218275209, 1.118615983326786, 0.9384726081223608, 14.91285747576828, 7.32878704534633, 1.3330323369923238, 0.8086448325482852, 1.4846119817407637, 1.9101146180726014, 1.820528137994807, 0.5931529410743066, 9.64947144774076, 22.55932256265289, 1.0755807315776271, 0.8837276966349054, 6.218217784370633, 10.157619137543973, 1.3177834526582788, 1.480541998766023, 0.3838307162972656, 0.9462396639467998, 1.0608152997812241, 3.4825042888814592, 28.497755039737957, 1.324852133265352, 0.7747084629167436, 0.8620897793171883, 1.6736230247703283, 14.438066106414041, 0.5347758127243659, 1.822420697205429, 25.994475208236683, 2.7208193702440493, 20.583413941743032, 3.069499802890687, 19.08415115547061, 1.08733947812735, 4.814492962545877, 1.5564240065206072, 1.55015344117217, 20.100020867918282, 1.5966111797760583, 1.142129733086061, 3.102846822555082, 1.1568789441645113, 0.544457152823053, 3.1098423074954886, 1.122679062053966, 2.924651586144188, 4.010739093429053, 2.236389561621253, 10.244447300520662, 3.7471450543766434, 5.752435661990681, 12.534567501316166, 12.29778903412252, 5.876294872417247, 0.9711016601913833, 1.223373155828711, 1.1684113035734693, 0.4720541822104693, 1.3407618525989582, 7.146623990425911, 2.9284845327603746, 5.573524932909857, 5.401014539157942, 0.5283820136933939, 1.262149634033918, 2.4829502164582284, 4.165898241476539, 4.893270923947702, 2.645660836601074, 0.8474930126353206));
    }
    
    @Test
    public void testBasicMotions() throws Exception {
//        testDistanceMeasureOnBasicMotions(new DTWDistanceConfigs.DTWSpaceBuilder(), 1000);
        testDistanceMeasureOnBasicMotions(new DTWDistanceConfigs.DTWSpaceBuilder(), newArrayList(1345.1338525905828, 19172.61829130168, 25288.501593816563, 31848.25448172975, 28418.314984095825, 0.0, 330.83449721446283, 36.116305395844, 20333.837023204236, 22527.64766771097, 1280.346741321642, 635.0653709080103, 42106.26950242675, 18406.88471405606, 33585.71712022664, 25674.678111847952, 12481.120342824486, 33594.25999388498, 34997.44103881234, 25269.25383742956, 758.0056899325697, 27535.191578807313, 21992.950085579887, 24376.386725312794, 28124.236575016104, 25520.58000525345, 36772.702211357835, 37112.93849536464, 12264.01846285003, 956.2746637460839, 577.3725414616799, 20309.009318279655, 18015.976959075255, 10590.825595990484, 34292.591580074055, 23197.277761476053, 60.73726175245901, 27717.53175771029, 0.0, 32407.351630563426, 31598.93900530552, 480.1832231749412, 1518.2351285637385, 30009.073567144176, 159.25319881656202, 35817.501939205365, 7858.028686788877, 15053.119038928782, 33124.46071857148, 16738.480600553863, 25420.113786445443, 31436.650822218988, 18566.01036043871, 1710.2546335340867, 25776.46442241803, 382.2190374666922, 11628.497508255896, 695.5592243236551, 16149.323960630265, 18493.24587632335, 1091.3015805235195, 12302.727346721069, 39980.37546127886, 12386.5951320835, 1449.2926093516767, 10665.379560122108, 582.946265959972, 28251.26565865865, 40562.7793788813, 32267.53113601759, 582.946265959972, 17179.238197139188, 27543.571275812847, 31516.181277786218, 35710.08736562123, 803.1651227012466, 12382.526562244757, 0.0, 18825.26377142506, 587.3036441484081, 27627.52598615885, 6272.090021024943, 9992.992858998183, 160.78657326821403, 40609.10075996731, 179.32115842351595, 1384.7520133081339, 41650.93671903042, 31749.134679292965, 41261.95146506333, 6134.099791634907, 28389.736149122542, 23195.867793653808, 8897.801419370784, 21076.809303321887, 27342.009326197764, 12403.715948268542, 29887.81128250868, 1604.74560407738, 1151.549440703032, 34367.44763488353, 27229.331162356655, 30009.073567144176, 29601.00553580184, 16887.953155392086, 11070.692972295603, 35344.92118651212, 18340.116352960446, 33840.99747276595, 32636.57849760675, 1631.272456943982, 22188.22356917401, 27769.7570274738, 1518.745167995256, 817.9591158026758, 41087.56391278405, 27209.74277901016, 32213.590827124335, 26689.57217001, 20448.79697560089, 33355.00691527915, 40838.25189354523, 6816.943307319507, 33124.46071857148, 34364.42627057588, 1855.5139715003736, 343.241654950656, 1238.1037580612772, 29601.00553580184, 852.331919757317, 93.63795082486806, 0.0, 68.14685655569104, 20820.896865027094, 16887.953155392086, 20862.174198278077, 155.652708558195, 27664.119517063627, 25288.501593816563, 17680.833206719373, 2066.853377676834, 27665.485912211123, 32662.372622608942, 37943.01640360877, 959.0925497083359, 13630.94927845215, 29909.47080233553, 29.73278288105699, 33755.56787064515, 41543.591295032275, 914.1532060345579, 12403.715948268542, 24379.007406966975, 989.1135364859873, 18825.26377142506, 24550.21002007393, 68.14685655569104, 19989.7778408572, 8897.801419370784, 35894.18938087284, 33611.146604181784, 30171.653426605037, 2094.6112059947277, 1076.807155295994, 25133.03955088296, 17006.20031070076, 21076.809303321887, 27266.04605521367, 27557.289540483227, 19631.454995123095, 33059.22984271801, 33505.925562639924, 58.122621938658014, 12392.353768080782, 13789.299924358847, 1898.7431554060665, 28028.399150667898, 451.54170043452206, 1151.545763430925, 33824.10271952835, 9485.305429605016, 21459.978235975632, 1062.4595069646055, 25119.29876273588, 13770.314790129903, 1969.9552573658414, 25082.969974091364, 35385.47751933543, 1151.549440703032, 15982.356721623566, 16984.94067597831, 35894.18938087284, 36163.93305846172, 30565.007058766605, 38535.44621241505, 730.079937986686, 30031.111433016154, 41604.97060206225, 36080.30571875111, 25082.969974091364, 29113.72442314772, 29873.113795179463, 21220.999299310974, 36963.68205175364, 36163.93305846172, 17038.731725156737, 1870.2045272508844, 17584.313377940056, 33056.260644157184, 20862.174198278077, 1202.889279338792, 29547.564098035527, 21017.67458554421, 39821.641886172365, 27009.95618026538, 271.99890729778315, 42453.59566558153, 101.19041712924401, 12811.657787056698, 27545.81651403443, 976.2814401866772, 39041.298505558545, 306.151680613482, 23197.277761476053, 30565.007058766605, 544.1908616312546, 1489.8684131939726, 27266.04605521367, 21606.792177365685, 8223.107394867355, 29962.804363285046, 35359.142441727796, 673.8772942800006, 30594.333255432583, 480.1832231749412, 29144.331773485497, 18277.02666594307, 162.52728822632702, 8537.26254406321, 1550.4053987623195, 58.768907742233, 34882.472231531305, 26888.675613905583, 1384.7520133081339, 34558.75718359154, 17082.194446262693, 9592.416437081683, 839.4566958398825, 17038.731725156737, 41650.93671903042, 32040.921237853785, 21857.0398987005, 25058.716635045796, 27362.034556776987, 30098.64951001908, 951.8664175274372, 357.03964009057705, 30408.315493367638, 13427.65224902484, 27527.87780488766, 28251.26565865865, 30173.02887747718, 1087.0343288905406, 10590.825595990484, 24047.764962160716, 480.1832231749412, 1234.9672183927441, 19796.14352922448, 37814.53418187225, 26093.209380920507, 673.9806057411123, 31107.60855686032, 35622.861934730005, 23197.277761476053, 27564.37150005197, 772.8321204887399, 200.35525614770714, 12693.622529790491, 175.25940005477008, 28641.85563145554, 33824.10271952835, 13634.073581015487, 1208.812298814022, 24412.64405407872, 803.1651227012466, 32273.183080480212, 19549.027523262303, 8825.244437563912, 9485.305429605016, 952.7593609191039, 17022.06977505755, 22458.717497638812, 956.2746637460839, 35034.80083895904, 32385.009312875627, 696.1638616754819, 33824.10271952835, 29283.517678983302, 19376.527532669737, 17167.648588849996, 35597.2681996966, 27362.034556776987, 19231.625378255023, 20328.865810559753, 8917.525123234473, 24480.135737878325, 8493.439470266407, 20328.865810559753, 27009.95618026538, 27014.667576530468, 15963.855592809578, 12481.120342824486, 37641.00148207191, 27669.564856284094, 35323.22354207742, 31788.99614698846, 31518.239415811375, 14335.477759970729, 16993.156852864857, 428.7290289849561, 36684.53364795461, 27669.564856284094, 952.7593609191039, 17000.57932735004, 22877.730719100877, 333.927401705443, 670.8979049194605, 984.2160292230284, 1089.2022815025457, 31107.60855686032, 77.90452079849601, 1283.581656271899, 22820.189587229794, 35356.07560268429, 772.8321204887399, 31926.675026009212, 42090.32967209171, 29873.655844853598, 24637.11441047667, 32081.156800615736, 10631.836656176883, 1211.4612652517321, 31602.86207268348, 159.25319881656202, 16531.999744824938, 7925.747418267602, 1138.0644548265473, 8223.107394867355, 16818.620784756353, 17179.092939856553, 951.8664175274372, 21692.036165298312, 43750.36104754198, 1816.5976691565277, 21532.124213757284, 23188.933172187975, 228.43645585683103, 33453.248514378996, 13725.470765875085, 32410.443113012938, 27234.116061251694, 0.0, 30031.111433016154, 38535.44621241505, 569.4644219760362, 25420.113786445443, 1603.8946504807323, 37112.93849536464, 6272.090021024943, 32255.896794759603, 156.99685533250306, 12802.521912782997, 13711.816033510666, 270.9123814362197, 18462.071128826017, 28349.507496261624, 19436.385083728048, 1603.8946504807323, 1569.42453366238, 16622.78909074753, 18462.071128826017, 35499.64722551047, 25423.4140460167, 13770.314790129903, 55.333286620703014, 15053.119038928782, 21212.03657160936, 10710.567064239936, 706.3755233867481, 29466.540720580742, 22877.730719100877, 25362.73607751565, 21857.0398987005, 43014.44544907338, 29909.64096482235, 19348.311304094856, 26329.65268279661, 1050.035851609291, 26699.312145470805, 12717.82854919085, 1151.17431019331, 920.5163157513197, 24991.865334135207, 2062.5435380228796, 13427.65224902484, 68.14685655569104, 17955.82185614216, 28251.26565865865, 30355.033331975523, 140.141779424241, 29984.68894802961, 38752.146546160184, 19155.48345678442, 25423.4140460167, 1384.7520133081339, 32040.921237853785, 696.1638616754819, 26366.210965857572, 333.927401705443, 17257.398057859813, 35313.9057629982, 13634.073581015487, 824.006940076762, 17382.05413343213, 874.4197310869332, 32040.921237853785, 29983.11998612074, 25423.4140460167, 17775.570279991036, 15616.238913462652, 19231.625378255023, 8033.232811862706, 27769.7570274738, 18493.24587632335, 34367.44763488353, 1859.6666845653963, 22948.10796194204, 31358.415693669347, 182.39091393009102, 28641.85563145554, 37723.11094742029, 12802.521912782997, 160.78657326821403, 35702.30810492355, 26837.999155452344, 1179.1547399461654, 27888.28731809972, 18674.420247631464, 759.7126755339796, 24285.81523640642, 1154.4217239144657, 12802.521912782997, 21459.978235975632, 31952.864662109143, 984.2160292230284, 31066.16366772854, 15616.238913462652, 152.347599146981, 35702.30810492355, 796.8683500332025, 905.775141332426, 930.8940240758413, 1411.217866712408, 1020.2258575245507, 30991.814478918517, 1997.838609931313, 25423.4140460167, 25677.10605676834, 1025.52457823165, 18011.199481356736, 39501.94708792259, 757.3160494140457, 1620.0495597642337, 27564.37150005197, 37995.81710783345, 17677.125162167617, 24469.212686481533, 730.079937986686, 22455.57952024942, 18117.004564242692, 16149.323960630265, 30229.307438180505, 17934.857119281518, 36010.73742682854, 681.356502689858, 28028.399150667898, 17044.343187635503, 32177.125674215076, 14789.522836670512, 14335.477759970729, 32156.349909069457, 18236.911131058918, 25058.716635045796, 13725.470765875085, 18796.96129097439, 29154.173830335054, 37913.47268418302, 13247.876743524685, 696.1638616754819, 18976.559180565033, 28251.26565865865, 1102.6190291937198, 1247.3261075790247, 21032.23070276301, 17298.729401688783, 19797.49268253842, 30199.724629058834, 34799.06957653671, 30805.42324992343, 20487.98052497302, 38841.28097463256, 24774.224268536243, 25133.03955088296, 32410.443113012938, 18402.237824496464, 15071.680988403734, 30933.64239664626, 12816.20032900955, 26965.72408507596, 1208.5296912502997, 29016.15095036212, 35078.57228946811, 30838.842957145032, 9849.216015127653, 1398.447678045283, 25420.113786445443, 18494.101537419785, 13999.508906794756, 81.50949719834799, 31516.181277786218, 1070.0267965648106, 15318.902936386978, 33964.24100146383, 25676.196234857012, 8069.65694151066, 25885.002108768593, 40313.20985144674, 0.0, 37723.11094742029, 19797.49268253842, 8033.232811862706, 35817.501939205365, 6295.895938882392, 14069.876272662521, 9375.718073382806, 27556.4487606934, 959.0925497083359, 36537.71631492448, 16551.268641881426, 24414.98076071093, 25286.014342521412, 17677.125162167617, 30565.007058766605, 920.5163157513197, 29016.15095036212, 24379.007406966975, 33594.25999388498, 15342.902490101558, 1490.7602844243052, 12785.678587796001, 1529.0132730525877, 19776.96743446033, 35576.72675484701, 6816.943307319507, 30157.979062217288, 25037.536414844395, 25168.453579494817, 33047.68520297934, 26637.642372261296, 977.6754199483519, 38250.81865574477, 33611.146604181784, 15071.680988403734, 27821.190772317957, 670.8979049194605, 896.4859847430265, 16598.473661989403, 31788.99614698846, 26366.210965857572, 24281.464518368328, 18340.116352960446, 15377.299005925866, 26689.57217001, 33935.442464409505, 42199.18696096324, 31518.239415811375, 21674.29628802627, 28124.236575016104, 38900.35398101282, 24932.232865811413, 30031.111433016154, 582.0908026891063, 16887.953155392086, 1898.7431554060665, 13725.470765875085, 24532.17505117497, 25093.50160906741, 17294.089887496863, 140.141779424241, 175.46036239144303, 21692.036165298312, 833.83512385727, 21541.38815262991, 43.19518972976999, 29113.72442314772, 2085.2129822237875, 29025.337445899866, 16680.518047184578, 37641.00148207191, 34149.16852879751, 22067.69125796667, 17916.950846607255, 1151.549440703032, 20487.98052497302, 29016.15095036212, 55.333286620703014, 32287.290346532347, 852.4222826296013, 39161.24267805328, 43014.44544907338, 32407.351630563426, 977.6754199483519, 25674.678111847952, 60.73726175245901, 212.780032482642, 18712.258640675173, 29961.293010846777, 12785.678587796001, 9906.002465637124, 39821.641886172365, 20286.045012206825, 975.3724007831987, 8069.65694151066, 9491.274386011684, 22364.467520239876, 30229.307438180505, 21173.492478119693, 25321.84574097106, 7252.347496922323, 15071.680988403734, 41729.71760514483, 35359.142441727796, 9849.216015127653, 20815.393062600164, 9999.553305931382, 920.5163157513197, 1006.2917789810255, 18674.420247631464, 34438.22962127872, 35405.598790399476, 13725.470765875085, 2122.819176238494, 1529.0132730525877, 23309.33020528439, 1936.8827484359863, 886.7983814732437, 42106.26950242675, 17584.313377940056, 30144.75940163937, 10631.836656176883, 8648.436002920205, 200.35525614770714, 19689.415385177388, 31890.088123070705, 0.0, 9906.002465637124, 20260.777543608165, 32515.806514902382, 28968.946449536503, 14431.81646334496, 1006.2917789810255, 24060.199901847853, 32711.708618764806, 37777.16843362389, 12302.727346721069, 851.8307607757928, 30991.814478918517, 25423.4140460167, 1269.429978087866, 17019.690092595436, 22920.29336345558, 124.45701392379698, 18832.091471876833, 1199.0327228358972, 951.8664175274372, 27229.331162356655, 691.1200581766949, 904.6684479555938, 35622.861934730005, 36035.534625080836, 16602.050139798135, 28817.712828616855, 35817.501939205365, 17858.93713234238, 30057.04059259423, 14321.62056808688, 12386.5951320835, 1105.6230880107223, 23188.933172187975, 9854.150946448564, 27833.870421592008, 12386.5951320835, 41087.56391278405, 55.333286620703014, 25420.113786445443, 29899.778492868452, 19353.203806855403, 1569.9357755074711, 691.1200581766949, 1384.7520133081339, 19918.776702406412, 30870.288797086774, 20487.98052497302, 587.3036441484081, 1062.4595069646055, 13770.314790129903, 22654.099369594252, 0.0, 1108.6608715994355, 23666.461464510357, 170.04460372954, 30199.724629058834, 12839.287296464252, 0.0, 15488.390062172966, 13347.59150818592, 19584.399597041345, 12693.622529790491, 31834.223842938263, 14026.330476506868, 55.333286620703014, 25244.44157353306, 31247.32695354123, 28968.946449536503, 12264.01846285003, 27685.072766030284, 20309.009318279655, 817.9591158026758, 27009.95618026538, 13999.508906794756, 32869.20531693456, 40797.09937621596, 29909.47080233553, 36822.9014609669, 10754.64383590165, 39828.478483728475, 21541.38815262991, 1494.2585378697863, 22389.624198025114, 40063.93500111735, 25812.774794623554, 31107.60855686032, 32940.31639850922, 33935.442464409505, 41120.28565677672, 38995.707675296624, 30565.007058766605, 35359.142441727796, 33719.21350292675, 41938.77439630868, 8155.645879539556, 15675.62807547093, 21220.999299310974, 21177.726536658345, 32646.208287769845, 7252.347496922323, 17476.29212980985, 12717.82854919085, 40562.7793788813, 28641.85563145554, 40313.20985144674, 904.6684479555938, 55.333286620703014, 15447.78306874721, 1855.5139715003736, 9375.718073382806, 8425.302808608101, 30057.04059259423, 12165.94993196245, 22455.57952024942, 32953.20544639024, 13197.395666474475, 12643.26956196359, 27627.52598615885, 24445.621709842504, 35187.06701626496, 32038.309667310208, 25420.113786445443, 31926.31602288003, 27374.05103809735, 5916.226120413061, 12593.41319832759, 29909.47080233553, 695.5592243236551, 26337.38927536714, 839.4566958398825, 41271.64123893106, 1449.2926093516767, 29018.091864190897, 36080.30571875111, 170.04460372954, 14446.59457062766, 1603.8946504807323, 29376.439571798324, 32407.351630563426, 26500.89953012341, 382.2190374666922, 930.8940240758413, 1657.1204497248466, 32245.950088932157, 17294.089887496863, 7858.028686788877, 17775.570279991036, 673.9806057411123, 306.151680613482, 25338.236460990876, 55.333286620703014, 31396.280599939848, 24606.45091734266, 42090.32967209171, 17166.158781039645, 343.241654950656, 31989.316714294884, 27401.83082577237, 672.8769226102601, 16887.953155392086, 24281.464518368328, 42106.26950242675, 17934.857119281518, 35941.85081989932, 9107.093703754037, 570.5564999209471, 34572.97613404637, 41650.93671903042, 31848.25448172975, 7626.224025962995, 25812.774794623554, 34837.51360761005, 9849.216015127653, 31358.415693669347, 36669.0039037804, 30419.067832230492, 9854.150946448564, 131.51338065569502, 930.8940240758413, 19224.793934646972, 29016.15095036212, 15568.89522030075, 99.17245389054901, 32407.351630563426, 35010.19717850303, 24480.135737878325, 803.6094877936382, 15675.62807547093, 32407.351630563426, 21459.978235975632, 582.0908026891063, 33594.25999388498, 35558.24726808504, 19757.69797611263, 18117.004564242692, 26337.38927536714, 18277.02666594307, 24774.224268536243, 35105.35573182257, 37777.16843362389, 19723.278191598438, 35708.88049202313, 1151.549440703032, 2122.819176238494, 12426.62893881051, 25674.678111847952, 20127.60513931383, 20328.865810559753, 17367.04166964567, 1339.2487431582197, 1138.0644548265473, 21032.23070276301, 28968.946449536503, 270.9123814362197, 38611.14055632304, 24638.623813591497, 1276.2616306221687, 22458.717497638812, 22083.701538694346, 28707.000998065083, 1234.9672183927441, 10754.64383590165, 21459.978235975632, 22492.832505936116, 1279.8945490341182, 13770.314790129903, 13765.679001367616, 12403.715948268542, 12386.5951320835, 18462.071128826017, 16622.78909074753, 40313.20985144674, 162.52728822632702, 17382.05413343213, 1345.1338525905828, 77.90452079849601, 641.2579973965842, 152.347599146981, 38613.062533773824, 1076.807155295994, 93.63795082486806, 25244.44157353306, 817.9591158026758, 19689.415385177388, 1657.1204497248466, 29154.173830335054, 20794.605416560215, 27362.034556776987, 19407.04704383256, 24991.865334135207, 480.1832231749412, 19841.53278359572, 159.25319881656202, 807.5854723384266, 30132.867406770496, 35621.75062360333, 21212.03657160936, 1734.2869358040907, 31358.415693669347, 33023.68013616123, 1345.1338525905828, 29.73278288105699, 155.652708558195, 35531.4559819054, 8375.127600495796, 12481.120342824486, 1569.42453366238, 0.0, 20815.393062600164, 13411.232833714274, 11628.497508255896, 18340.116352960446, 36.116305395844, 35313.9057629982, 16249.727137000547, 852.331919757317, 22828.083939825956, 759.7126755339796, 24379.007406966975, 31107.60855686032, 8833.88380137036, 26170.75262424733, 38055.16180517958, 1804.7192462266175, 21760.10613461175, 1006.2917789810255, 1138.0644548265473, 33289.56385357981, 582.946265959972, 865.0812290982573, 1202.889279338792, 23416.96986182717, 8537.26254406321, 33676.204927069004, 727.071520405721, 23885.497694856458, 28483.33083886063, 11900.628887422261, 30991.814478918517, 1076.807155295994, 16100.568453776283, 36684.53364795461, 32038.309667310208, 131.51338065569502, 1105.6230880107223, 12802.521912782997, 28665.464648210615, 25269.25383742956, 7252.347496922323, 12403.715948268542, 24647.566514809685, 10665.379560122108, 25953.83398879504, 32711.708618764806, 1881.7573209499426, 1489.8684131939726, 25422.516798684348, 12165.94993196245, 19229.681126789183, 10710.567064239936, 28665.464648210615, 37723.11094742029, 37015.46018585023, 35359.142441727796, 278.76631042403403, 30559.553114241862, 124.45701392379698, 43014.44544907338, 39711.38952067967, 29.73278288105699, 36163.93305846172, 701.0738234116104, 20222.82803694181, 31358.415693669347));
    }
    
    public static void testDistanceMeasureOnGunPoint(ParamSpaceBuilder builder, List<Double> distances)
            throws Exception {
        testDistanceMeasure(builder, DatasetLoading.loadGunPoint(), distances);
    }

    public static void testDistanceMeasureOnBeef(ParamSpaceBuilder builder, List<Double> distances)
            throws Exception {
        testDistanceMeasure(builder, DatasetLoading.loadBeef(), distances);
    }

    public static void testDistanceMeasureOnItalyPowerDemand(ParamSpaceBuilder builder, List<Double> distances)
            throws Exception {
        testDistanceMeasure(builder, DatasetLoading.loadItalyPowerDemand(), distances);
    }

    public static void testDistanceMeasureOnBasicMotions(ParamSpaceBuilder builder, List<Double> distances)
            throws Exception {
        testDistanceMeasure(builder, DatasetLoading.loadBasicMotions(), distances);
    }

    public static void testDistanceMeasureOnGunPoint(ParamSpaceBuilder builder, int numDistances)
            throws Exception {
        testDistanceMeasure(builder, DatasetLoading.loadGunPoint(), numDistances);
    }

    public static void testDistanceMeasureOnBeef(ParamSpaceBuilder builder, int numDistances)
            throws Exception {
        testDistanceMeasure(builder, DatasetLoading.loadBeef(), numDistances);
    }

    public static void testDistanceMeasureOnItalyPowerDemand(ParamSpaceBuilder builder, int numDistances)
            throws Exception {
        testDistanceMeasure(builder, DatasetLoading.loadItalyPowerDemand(), numDistances);
    }

    public static void testDistanceMeasureOnBasicMotions(ParamSpaceBuilder builder, int numDistances)
            throws Exception {
        testDistanceMeasure(builder, DatasetLoading.loadBasicMotions(), numDistances);
    }
    
    public static void testDistanceMeasure(ParamSpaceBuilder paramSpaceBuilder, Instances data, int numDistances) {
        testDistanceMeasure(paramSpaceBuilder, Converter.fromArff(data), numDistances);
    }
    
    public static void testDistanceMeasure(ParamSpaceBuilder paramSpaceBuilder, Instances data, List<Double> distances) {
        testDistanceMeasure(paramSpaceBuilder, Converter.fromArff(data), distances);
    }
    
    public static void testDistanceMeasure(ParamSpaceBuilder paramSpaceBuilder, TimeSeriesInstances data, int numDistances) {
        forEachDistanceTest(paramSpaceBuilder, data, new DistancePrinter(), numDistances);
    }
    
    public static void testDistanceMeasure(ParamSpaceBuilder paramSpaceBuilder, TimeSeriesInstances data, List<Double> distances) {
        forEachDistanceTest(paramSpaceBuilder, data, new TestDistanceEquality(distances), distances.size());
    }
    
    public interface DistanceTest {
        void handle(int i, DistanceMeasure distanceMeasure, TimeSeriesInstance a, TimeSeriesInstance b);
        default void end() {}
    }
    
    public static class TestDistanceEquality implements DistanceTest {
        
        private final List<Double> distances;
        
        public TestDistanceEquality(List<Double> distances) {
            this.distances = distances;
        }
        
        @Override public void handle(int i, final DistanceMeasure distanceMeasure, final TimeSeriesInstance inst1,
                final TimeSeriesInstance inst2) {
            if(distanceMeasure instanceof MatrixBasedDistanceMeasure) {
                ((MatrixBasedDistanceMeasure) distanceMeasure).setGenerateDistanceMatrix(false);
            }
            final double distanceWithoutLimit = distanceMeasure.distance(inst1, inst2);
            Assert.assertEquals(distances.get(i), distanceWithoutLimit, 0d);
            final double limit = distanceWithoutLimit / 2;
            final double distanceWithLimit = distanceMeasure.distance(inst1, inst2, limit);
            Assert.assertTrue(
                    distanceWithLimit == distanceWithoutLimit || distanceWithLimit == Double.POSITIVE_INFINITY);
            if(distanceMeasure instanceof MatrixBasedDistanceMeasure) {
                ((MatrixBasedDistanceMeasure) distanceMeasure).setGenerateDistanceMatrix(true);
                final double distanceWithMatrix = distanceMeasure.distance(inst1, inst2);
            }
        }
    };
    public static class DistancePrinter implements DistanceTest {

        private final List<Double> distances = new ArrayList<>();
        
        @Override public void handle(int i, final DistanceMeasure distanceMeasure, final TimeSeriesInstance a,
                final TimeSeriesInstance b) {
            distances.add(distanceMeasure.distance(a, b));
        }

        @Override public void end() {
            System.out.println(distances);
            Assert.fail("distances computed");
        }
    };
    
    private static void forEachDistanceTest(ParamSpaceBuilder paramSpaceBuilder, TimeSeriesInstances data, DistanceTest test, int numTests) {
        final long time = System.nanoTime();
        // conduct several random tests of random distance measure parameters + random insts
        final Random random = new Random(0);
        final RandomSearch randomSearch = new RandomSearch();
        randomSearch.setRandom(random);
        randomSearch.setIterationLimit(numTests);
        final ParamSpace paramSpace = paramSpaceBuilder.build(data);
        randomSearch.buildSearch(paramSpace);
        for(int i = 0; i < numTests; i++) {
            final int i1 = random.nextInt(data.numInstances());
            int i2 = 0;
            do {
                i2 = random.nextInt(data.numInstances());
            } while(i2 == i1);
            if(!randomSearch.hasNext()) {
                throw new IllegalStateException("random search should never run out");
            }
            final ParamSet paramSet = randomSearch.next();
            final TimeSeriesInstance inst1 = data.get(i1);
            final TimeSeriesInstance inst2 = data.get(i2);
            final DistanceMeasure distanceMeasure = paramSet.getSingle(DistanceMeasure.DISTANCE_MEASURE_FLAG);
            test.handle(i, distanceMeasure, inst1, inst2);
        }
        final long seconds = TimeUnit.SECONDS.convert(System.nanoTime() - time, TimeUnit.NANOSECONDS);
        final String msg = "distances computed in " + seconds + "s";
        System.out.println(msg);
        test.end();
    }

    public static Instances buildInstances() {
        return InstanceTools.toWekaInstancesWithClass(new double[][] {
            {1,2,3,4,5,0},
            {6,11,15,2,7,1}
        });
    }

    private Instances instances;
    private DTWDistance df;

    @Before
    public void before() {
        instances = buildInstances();
        df = new DTWDistance();
        df.buildDistanceMeasure(instances);
    }

    @Test
    public void testFullWarp() {
        df.setWindowSize(1);
        double distance = df.distance(instances.get(0), instances.get(1));
        Assert.assertEquals(distance, 203, 0);
    }

    @Test
    public void testConstrainedWarp() {
        df.setWindowSize(0.4);
        double distance = df.distance(instances.get(0), instances.get(1));
        Assert.assertEquals(distance, 212, 0);
    }

    private static double origDtw(Instance first, Instance second, double limit, int windowSize) {

        double minDist;
        boolean tooBig;

        int aLength = first.numAttributes() - 1;
        int bLength = second.numAttributes() - 1;

        /*  Parameter 0<=r<=1. 0 == no warpingWindow, 1 == full warpingWindow
         generalised for variable window size
         * */
//        int windowSize = warpingWindow + 1; // + 1 to include the current cell
//        if(warpingWindow < 0) {
//            windowSize = aLength + 1;
//        }
        if(windowSize < 0) {
            windowSize = first.numAttributes() - 1;
        } else {
            windowSize++;
        }
        //Extra memory than required, could limit to windowsize,
        //        but avoids having to recreate during CV
        //for varying window sizes
        double[][] distanceMatrix = new double[aLength][bLength];

        /*
         //Set boundary elements to max.
         */
        int start, end;
        for(int i = 0; i < aLength; i++) {
            start = windowSize < i ? i - windowSize : 0;
            end = Math.min(i + windowSize + 1, bLength);
            for(int j = start; j < end; j++) {
                distanceMatrix[i][j] = Double.POSITIVE_INFINITY;
            }
        }
        distanceMatrix[0][0] = (first.value(0) - second.value(0)) * (first.value(0) - second.value(0));
        //a is the longer series.
        //Base cases for warping 0 to all with max interval	r
        //Warp first[0] onto all second[1]...second[r+1]
        for(int j = 1; j < windowSize && j < bLength; j++) {
            distanceMatrix[0][j] =
                distanceMatrix[0][j - 1] + (first.value(0) - second.value(j)) * (first.value(0) - second.value(j));
        }

        //	Warp second[0] onto all first[1]...first[r+1]
        for(int i = 1; i < windowSize && i < aLength; i++) {
            distanceMatrix[i][0] =
                distanceMatrix[i - 1][0] + (first.value(i) - second.value(0)) * (first.value(i) - second.value(0));
        }
        //Warp the rest,
        for(int i = 1; i < aLength; i++) {
            tooBig = true;
            start = windowSize < i ? i - windowSize + 1 : 1;
            end = Math.min(i + windowSize, bLength);
            if(distanceMatrix[i][start - 1] < limit) {
                tooBig = false;
            }
            for(int j = start; j < end; j++) {
                minDist = distanceMatrix[i][j - 1];
                if(distanceMatrix[i - 1][j] < minDist) {
                    minDist = distanceMatrix[i - 1][j];
                }
                if(distanceMatrix[i - 1][j - 1] < minDist) {
                    minDist = distanceMatrix[i - 1][j - 1];
                }
                distanceMatrix[i][j] =
                    minDist + (first.value(i) - second.value(j)) * (first.value(i) - second.value(j));
                if(tooBig && distanceMatrix[i][j] < limit) {
                    tooBig = false;
                }
            }
            //Early abandon
            if(tooBig) {
                return Double.POSITIVE_INFINITY;
            }
        }
        //Find the minimum distance at the end points, within the warping window.
        double distance = distanceMatrix[aLength - 1][bLength - 1];
        return distance;



//        double[] a = ExposedDenseInstance.extractAttributeValuesAndClassLabel(first);
//        double[] b = ExposedDenseInstance.extractAttributeValuesAndClassLabel(bi);
//        double[][] matrixD = null;
//        double minDist;
//        boolean tooBig;
//        // Set the longest series to a. is this necessary?
//        double[] temp;
//        if(a.length<b.length){
//            temp=a;
//            a=b;
//            b=temp;
//        }
//        int n=a.length-1;
//        int m=b.length-1;
///*  Parameter 0<=r<=1. 0 == no warp, 1 == full warp
//generalised for variable window size
//* */
////        windowSize = getWindowSize(n);
//        //Extra memory than required, could limit to windowsize,
//        //        but avoids having to recreate during CV
//        //for varying window sizes
//        if(matrixD==null)
//            matrixD=new double[n][m];

/*
//Set boundary elements to max.
*/
//        int start,end;
//        for(int i=0;i<n;i++){
//            start=windowSize<i?i-windowSize:0;
//            end=i+windowSize+1<m?i+windowSize+1:m;
//            for(int j=start;j<end;j++)
//                matrixD[i][j]=Double.MAX_VALUE;
//        }
//        matrixD[0][0]=(a[0]-b[0])*(a[0]-b[0]);
//        //a is the longer series.
//        //Base cases for warping 0 to all with max interval	r
//        //Warp a[0] onto all b[1]...b[r+1]
//        for(int j=1;j<windowSize && j<m;j++)
//            matrixD[0][j]=matrixD[0][j-1]+(a[0]-b[j])*(a[0]-b[j]);
//
//        //	Warp b[0] onto all a[1]...a[r+1]
//        for(int i=1;i<windowSize && i<n;i++)
//            matrixD[i][0]=matrixD[i-1][0]+(a[i]-b[0])*(a[i]-b[0]);
//        //Warp the rest,
//        for (int i=1;i<n;i++){
//            tooBig=true;
//            start=windowSize<i?i-windowSize+1:1;
//            end=i+windowSize<m?i+windowSize:m;
//            for (int j = start;j<end;j++){
//                minDist=matrixD[i][j-1];
//                if(matrixD[i-1][j]<minDist)
//                    minDist=matrixD[i-1][j];
//                if(matrixD[i-1][j-1]<minDist)
//                    minDist=matrixD[i-1][j-1];
//                matrixD[i][j]=minDist+(a[i]-b[j])*(a[i]-b[j]);
//                if(tooBig&&matrixD[i][j]<cutoff)
//                    tooBig=false;
//            }
//            //Early abandon
//            if(tooBig){
//                return Double.MAX_VALUE;
//            }
//        }
//        //Find the minimum distance at the end points, within the warping window.
//        return matrixD[n-1][m-1];
    }
    
    @Test
    public void testVariableLengthTimeSeries() {
        DTWDistance dtw = new DTWDistance();
        dtw.setGenerateDistanceMatrix(true);
        dtw.setWindowSize(1);
        TimeSeriesInstances tsinsts = new TimeSeriesInstances(new double[][][]{
                {
                        {7, 6, 1, 7, 7, 7, 3, 3, 5, 6}
                },
                {
                        {5, 3, 2, 7, 4, 2, 1, 8, 8, 7, 4, 4, 2, 1, 3}
                }
        }, new double[]{0, 0});
        double distance = dtw.distance(tsinsts.get(0), tsinsts.get(1));
        Assert.assertEquals(57, distance, 0d);
//        System.out.println("[" + ArrayUtilities.toString(dtw.getDistanceMatrix(), ",", "]," + System.lineSeparator() + "[") + "]");
        double otherDistance = dtw.distance(tsinsts.get(1), tsinsts.get(0));
        Assert.assertEquals(distance, otherDistance, 0d);
        double limit = 10;
        distance = dtw.distance(tsinsts.get(0), tsinsts.get(1), limit);
        Assert.assertEquals(Double.POSITIVE_INFINITY, distance, 0d);
        otherDistance = dtw.distance(tsinsts.get(1), tsinsts.get(0), limit);
        Assert.assertEquals(distance, otherDistance, 0d);
    }
    
    @Test
    public void testVariableLengthTimeSeriesConstrainedWarp() {
        DTWDistance dtw = new DTWDistance();
        dtw.setGenerateDistanceMatrix(true);
        dtw.setWindowSize(0.25);
        TimeSeriesInstances tsinsts = new TimeSeriesInstances(new double[][][]{
                {
                        {7, 6, 1, 7, 7, 7, 3, 3, 5, 6}
                },
                {
                        {5, 3, 2, 7, 4, 2, 1, 8, 8, 7, 4, 4, 2, 1, 3}
                }
        }, new double[]{0, 0});
        double distance = dtw.distance(tsinsts.get(0), tsinsts.get(1));
        Assert.assertEquals(57, distance, 0d);
        //        System.out.println("[" + ArrayUtilities.toString(dtw.getDistanceMatrix(), ",", "]," + System.lineSeparator() + "[") + "]");
        double otherDistance = dtw.distance(tsinsts.get(1), tsinsts.get(0));
        Assert.assertEquals(distance, otherDistance, 0d);
        double limit = 20;
        distance = dtw.distance(tsinsts.get(0), tsinsts.get(1), limit);
        Assert.assertEquals(Double.POSITIVE_INFINITY, distance, 0d);
        otherDistance = dtw.distance(tsinsts.get(1), tsinsts.get(0), limit);
        Assert.assertEquals(distance, otherDistance, 0d);
    }
}
